
<div class="verify-container">
<h1 class="verify-title">ğŸ”’ å®‰å…¨éªŒè¯�</h1>
<div class="info-box" id="mainInfoBox">
        è¯·ç¡®è®¤æ‚¨ä¸�æ˜¯æœºå™¨äºº å¼€å§‹éªŒè¯�
    </div>
<p class="verify-desc">
        éªŒè¯�æˆ�åŠŸå��ï¼Œ1å°�æ—¶å†…è®¿é—®è¯¥å¸–å­�æ— éœ€é‡�å¤�éªŒè¯�
    </p>
<form action="./thread-278661-1.htm" id="verifyForm" method="POST">
<input name="tid" type="hidden" value="278661"/>
<input id="NECaptchaValidate" name="NECaptchaValidate" type="hidden"/>
<div class="captcha-wrapper">
<div id="captcha"></div>
</div>
<button class="btn-submit" disabled="" id="submitBtn" type="submit">ç»§ç»­è®¿é—®</button>
<div class="countdown-tip" id="countdownTip">
<span id="countdownText"></span>
</div>
<div class="error-msg" id="errorMsg"></div>
</form>
</div>
<!-- ç½‘æ˜“äº‘ç›¾éªŒè¯�ç �JS -->
<script src="https://cstaticdun.126.net/load.min.js"></script>
<script>
var captchaIns;
var countdownTimer = null;
var countdownSeconds = 3;

// åˆ�å§‹åŒ–éªŒè¯�ç �
initNECaptcha({
    captchaId: 'e019d55cf18348519c201a0d2f80ebfb',
    element: '#captcha',
    mode: 'popup',
    width: '320px',
    onReady: function(instance) {
        captchaIns = instance;
    },
    onVerify: function(err, data) {
        if (err) {
            showError('éªŒè¯�å¤±è´¥ï¼Œè¯·é‡�è¯•');
            document.getElementById('submitBtn').disabled = true;
            return;
        }
        
        // éªŒè¯�æˆ�åŠŸ
        document.getElementById('NECaptchaValidate').value = data.validate;
        document.getElementById('submitBtn').disabled = false;
        hideError();
        
        // æ›´æ–°æ��ç¤ºä¿¡æ�¯
        var mainInfoBox = document.getElementById('mainInfoBox');
        mainInfoBox.className = 'info-box success';
        mainInfoBox.textContent = 'âœ“ éªŒè¯�æˆ�åŠŸï¼�';
        
        // å�¯åŠ¨å€’è®¡æ—¶
        startCountdown();
    }
}, function(instance) {
    // åˆ�å§‹åŒ–æˆ�åŠŸå��è‡ªåŠ¨å¼¹å‡ºéªŒè¯�ç �
    captchaIns = instance;
    instance.popUp();
}, function(err) {
    console.error('éªŒè¯�ç �åŠ è½½å¤±è´¥', err);
    showError('éªŒè¯�ç �åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé�¢é‡�è¯•');
});

// å�¯åŠ¨å€’è®¡æ—¶
function startCountdown() {
    var submitBtn = document.getElementById('submitBtn');
    var countdownTip = document.getElementById('countdownTip');
    var countdownText = document.getElementById('countdownText');
    
    // æ˜¾ç¤ºå€’è®¡æ—¶æ��ç¤º
    countdownTip.style.display = 'block';
    submitBtn.className = 'btn-submit countdown';
    
    // æ›´æ–°å€’è®¡æ—¶æ˜¾ç¤º
    function updateCountdown() {
        submitBtn.textContent = 'ç»§ç»­è®¿é—® (' + countdownSeconds + 's)';
        countdownText.textContent = countdownSeconds + ' ç§’å��è‡ªåŠ¨è·³è½¬...';
        
        if (countdownSeconds <= 0) {
            clearInterval(countdownTimer);
            submitBtn.textContent = 'æ­£åœ¨è·³è½¬...';
            countdownText.textContent = 'æ­£åœ¨è·³è½¬...';
            
            // è‡ªåŠ¨æ��äº¤è¡¨å�•
            document.getElementById('verifyForm').submit();
        }
        
        countdownSeconds--;
    }
    
    // ç«‹å�³æ‰§è¡Œä¸€æ¬¡
    updateCountdown();
    
    // æ¯�ç§’æ›´æ–°ä¸€æ¬¡
    countdownTimer = setInterval(updateCountdown, 1000);
}

// è¡¨å�•æ��äº¤éªŒè¯�
document.getElementById('verifyForm').addEventListener('submit', function(e) {
    var validate = document.getElementById('NECaptchaValidate').value;
    
    if (!validate) {
        e.preventDefault();
        showError('è¯·å…ˆå®Œæˆ�æ»‘åŠ¨éªŒè¯�');
        if (captchaIns) {
            captchaIns.popUp();
        }
        return false;
    }
    
    // å¦‚æ�œç”¨æˆ·æ‰‹åŠ¨ç‚¹å‡»ï¼Œæ¸…é™¤å€’è®¡æ—¶
    if (countdownTimer) {
        clearInterval(countdownTimer);
        document.getElementById('submitBtn').textContent = 'æ­£åœ¨è·³è½¬...';
        document.getElementById('countdownText').textContent = 'æ­£åœ¨è·³è½¬...';
    }
});

function showError(msg) {
    var errorMsg = document.getElementById('errorMsg');
    errorMsg.textContent = msg;
    errorMsg.style.display = 'block';
}

function hideError() {
    document.getElementById('errorMsg').style.display = 'none';
}
</script>