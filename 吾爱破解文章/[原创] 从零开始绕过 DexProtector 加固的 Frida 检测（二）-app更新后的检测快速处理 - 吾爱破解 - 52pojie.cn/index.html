<!DOCTYPE html>

<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport"/>
<meta content="webkit" name="renderer">
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<title>[原创] 从零开始绕过 DexProtector 加固的 Frida 检测（二）-app更新后的检测快速处理 - 吾爱破解 - 52pojie.cn </title>
<link href="https://www.52pojie.cn/thread-2086038-1-1.html" rel="canonical"/>
<meta content="[原创] 从零开始绕过 DexProtector 加固的 Frida 检测（二）-app更新后的检测快速处理" name="keywords"/>
<meta content="[md]# 从零开始绕过 DexProtector 加固的 Frida 检测（二）## app版本更新了，如何快速进行处理？如何使用frida-server实现过检测？（本文由 id：小佳、fyrlove、roy ... " name="description"/>
<meta content="Discuz!" name="generator"/>
<meta content="True" name="MSSmartTagsPreventParsing"/>
<meta content="Yes" http-equiv="MSThemeCompatible"/>

<link href="/favicon.svg" rel="mask-icon"/>
<link href="/favicon.svg" rel="icon" type="image/svg+xml"/>
<link href="apple-touch-icon.png" rel="apple-touch-icon"/>
<link href="apple-touch-icon.png" rel="apple-touch-icon" size="180x180"/>
<link href="apple-touch-icon-167x167.png" rel="apple-touch-icon" size="167x167"/>
<link href="apple-touch-icon-152x152.png" rel="apple-touch-icon" size="152x152"/><link href="https://static.52pojie.cn/cache/style_1_common.css?q9b" rel="stylesheet" type="text/css"><link href="https://static.52pojie.cn/cache/style_1_forum_viewthread.css?q9b" rel="stylesheet" type="text/css"><link href="./template/default/style/t5/style.css" id="css_extstyle" rel="stylesheet" type="text/css">
<meta content="吾爱破解 - 52pojie.cn" name="application-name"/>
<meta content="吾爱破解 - 52pojie.cn" name="msapplication-tooltip"/>
<meta content="name=门户;action-uri=https://www.52pojie.cn/portal.php;icon-uri=https://static.52pojie.cn/static/image/common/portal.ico" name="msapplication-task"/>
<meta content="name=网站;action-uri=https://www.52pojie.cn/forum.php;icon-uri=https://static.52pojie.cn/static/image/common/bbs.ico" name="msapplication-task"/>
<link href="https://www.52pojie.cn/archiver/" rel="archives" title="吾爱破解 - 52pojie.cn">
<link href="https://static.52pojie.cn/cache/style_1_widthauto.css?q9b" id="css_widthauto" rel="stylesheet" type="text/css">
<link href="https://static.52pojie.cn/cache/style_1_responsive.css?q9b" id="css_responsive" rel="stylesheet" type="text/css">
</link></link></link></link></link></link></meta></head>
<body class="pg_viewthread" id="nv_forum" onkeydown="if(event.keyCode==27) return false;">
<div id="append_parent"></div><div id="ajaxwaitid"></div>
<div class="cl" id="toptb">
<div class="wp">
<div class="z"><a href="https://space.bilibili.com/544451485" rel="nofollow" target="_blank">官方bilibili</a><a href="thread-582852-1-1.html" style="color: red" target="_blank">Windows破解入门</a><a href="thread-408645-1-1.html" style="color: red" target="_blank">Android逆向入门</a></div>
<div class="y">
<a class="switchblind" href="javascript:;" id="switchblind" onclick="toggleBlind(this)" title="开启辅助访问"></a>
<a href="thread-209287-1-1.html" target="_blank" title="修复各种访问不了论坛、访问论坛异常、验证码异常等各种问题的大杀器！">【网络诊断修复工具】</a><a class="switchwidth" href="javascript:;" id="switchwidth" onclick="widthauto(this)" title="切换到窄版">切换到窄版</a>
<a href="javascript:;" id="sslct" onmouseover="delayShow(this, function() {showMenu({'ctrlid':'sslct','pos':'34!'})});">切换风格</a></div>
</div>
</div>
<ul class="p_pop" disautofocus="true" id="myprompt_menu" style="display: none;">
<li><a href="home.php?mod=space&amp;do=pm" id="pm_ntc" style="background-repeat: no-repeat; background-position: 0 50%;"><em class="prompt_news_0"></em>消息</a></li>
<li><a href="home.php?mod=follow&amp;do=follower"><em class="prompt_follower_0"></em>新听众</a></li>
<li class="ignore_noticeli"><a href="javascript:;" onclick="setcookie('ignore_notice', 1);hideMenu('myprompt_menu')" title="暂不提醒"><em class="ignore_notice"></em></a></li>
</ul>
<div class="cl p_pop" id="sslct_menu" style="display: none;">
<span class="sslct_btn" onclick="extstyle('./template/default/style/t1')" title="红"><i style="background:#BA350F"></i></span>
<span class="sslct_btn" onclick="extstyle('./template/default/style/t2')" title="青"><i style="background:#429296"></i></span>
<span class="sslct_btn" onclick="extstyle('./template/default/style/t3')" title="橙"><i style="background:#FE9500"></i></span>
<span class="sslct_btn" onclick="extstyle('./template/default/style/t4')" title="紫"><i style="background:#9934B7"></i></span>
<span class="sslct_btn" onclick="extstyle('./template/default/style/t5')" title="蓝"><i style="background:#0053B9"></i></span>
</div>
<ul class="p_pop" id="myitem_menu" style="display: none;">
<li><a href="forum.php?mod=guide&amp;view=my">帖子</a></li>
<li><a href="home.php?mod=space&amp;do=favorite&amp;view=me">收藏</a></li>
<li><a href="home.php?mod=space&amp;do=friend">好友</a></li>
</ul>
<div class="p_pop" id="qmenu_menu" style="display: none;">
<ul class="cl nav"><li><a href="forum.php?mod=guide" style="background-image:url(https://static.52pojie.cn/static/image/feed/guide_b.png) !important">导读</a></li>
<li><a href="forum.php?mod=guide&amp;view=my" style="background-image:url(https://static.52pojie.cn/static/image/feed/thread_b.png) !important">帖子</a></li>
<li><a href="home.php?mod=space&amp;do=favorite&amp;view=me" style="background-image:url(https://static.52pojie.cn/static/image/feed/favorite_b.png) !important">收藏</a></li>
<li><a href="forum.php?mod=collection&amp;op=my" style="background-image:url(https://static.52pojie.cn/static/image/feed/collection_b.png) !important">淘帖</a></li>
<li><a href="home.php?mod=medal" style="background-image:url(https://static.52pojie.cn/static/image/feed/medal_b.png) !important">勋章</a></li>
<li><a href="home.php?mod=task" style="background-image:url(https://static.52pojie.cn/static/image/feed/task_b.png) !important">任务</a></li>
<li><a href="home.php?mod=space&amp;do=friend" style="background-image:url(https://static.52pojie.cn/static/image/feed/friend_b.png) !important">好友</a></li>
<li><a href="misc.php?mod=ranklist" style="background-image:url(https://static.52pojie.cn/static/image/feed/ranklist_b.png) !important">排行榜</a></li>
<li><a href="home.php?mod=spacecp&amp;ac=credit&amp;op=buy" style="background-image:url(https://static.52pojie.cn/static/image/feed/money.png) !important" title="论坛币捐助充值入口。">充值</a></li>
</ul>
<div class="btda" id="fjump_menu"></div></div><div id="hd">
<div class="wp">
<div class="hdc cl"><h2><a href="./" title="吾爱破解 - 52pojie.cn"><img alt="吾爱破解 - 52pojie.cn" border="0" src="../common_images/logo.png"/></a></h2><div id="um">
<div class="avt y"><a href="home.php?mod=space&amp;uid=588268"><img onerror="this.onerror=null;this.src='https://avatar.52pojie.cn/images/noavatar_small.gif'" src="../common_images/68_avatar_small.jpg"/></a></div>
<p>
<strong class="vwmy"><a href="https://github.com/jwmycz" target="_blank" style="color: #0366d6; text-decoration: none;">微信公众号：将往的爬虫逆向日记</a></strong>
<span class="pipe">|</span><a href="connect.php?mod=config" target="_blank"><img align="absmiddle" alt="QQ绑定" class="qq_bind" src="../common_images/qq_bind_small.gif"/></a>
<span class="pipe">|</span><a class="showmenu a" href="home.php?mod=space&amp;do=reward&amp;view=me" id="rewards" onmouseover="showMenu({'ctrlid':'rewards'})"><em class="showtipex"></em>悬赏</a><span class="pipe">|</span><a class="showmenu" href="javascript:;" id="myitem" onmouseover="showMenu({'ctrlid':'myitem'});">我的</a>
<span class="pipe">|</span><a href="home.php?mod=spacecp">设置</a>
<span class="pipe">|</span><a href="home.php?mod=space&amp;do=pm" id="pm_ntc">消息</a>
<span class="pipe">|</span><a class="a showmenu" href="home.php?mod=space&amp;do=notice" id="myprompt" onmouseover="showMenu({'ctrlid':'myprompt'});">提醒</a><span id="myprompt_check"></span>
<span class="pipe">|</span><a href="member.php?mod=logging&amp;action=logout&amp;formhash=7f5fdc25">退出</a>
</p>
<p>
<img align="absmiddle" alt="" class="qq_bind" src="../common_images/wbs.png"/> <span class="pipe">|</span><a class="showmenu" href="home.php?mod=spacecp&amp;ac=credit&amp;showcredit=1" id="extcreditmenu" onmouseover="delayShow(this, showCreditmenu);">积分: 233</a>
<span class="pipe">|</span><a class="showmenu" href="home.php?mod=spacecp&amp;ac=usergroup" id="g_upmine" onmouseover="delayShow(this, showUpgradeinfo)">用户组: 前途无量</a>
</p>
</div>
</div>
<div id="nv">
<a href="javascript:;" id="qmenu" onmouseover="delayShow(this, function () {showMenu({'ctrlid':'qmenu','pos':'34!','ctrlclass':'a','duration':2});showForummenu(65);})">快捷导航</a>
<ul><li id="mn_portal"><a hidefocus="true" href="portal.php" title="吾爱破解门户">门户<span>吾爱破解门户</span></a></li><li class="a" id="mn_forum"><a hidefocus="true" href="/" title="吾爱破解论坛">网站<span>吾爱破解论坛</span></a></li><li id="mn_Na063" onmouseover="showMenu({'ctrlid':this.id,'ctrlclass':'hover','duration':2})"><a hidefocus="true" href="forum.php?mod=guide&amp;view=newthread" style="color: yellow" title="吾爱破解论坛新帖导读">新帖<span>吾爱破解论坛新帖导读</span></a></li><li id="mn_forum_11"><a hidefocus="true" href="forum.php?mod=collection" title="吾爱破解文章专辑列表">专辑<span>吾爱破解文章专辑列表</span></a></li><li id="mn_home_4" onmouseover="showMenu({'ctrlid':this.id,'ctrlclass':'hover','duration':2})"><a hidefocus="true" href="home.php" title="Space">家园<span>Space</span></a></li><li id="mn_N12a7"><a hidefocus="true" href="misc.php?mod=ranklist" title="吾爱破解排行榜">排行榜<span>吾爱破解排行榜</span></a></li><li id="mn_N05be"><a hidefocus="true" href="thread-143136-1-1.html" target="_blank" title="吾爱破解论坛总版规">总版规<span>吾爱破解论坛总版规</span></a></li><li id="mn_N34c9"><a hidefocus="true" href="forum-15-1.html" target="_blank" title="吾爱破解论坛欢迎大家积极举报违规帖子!">投诉举报<span>吾爱破解论坛欢迎大家积极举报违规帖子!</span></a></li><li id="mn_Na678" onmouseover="showMenu({'ctrlid':this.id,'ctrlclass':'hover','duration':2})"><a hidefocus="true" href="https://down.52pojie.cn" style="font-weight: bold;color: yellow" target="_blank" title="爱盘，在线破解工具包，实时提供最新逆向资源！">爱盘<span>爱盘，在线破解工具包，实时提供最新逆向资源！</span></a></li><li id="mn_N0a2c"><a hidefocus="true" href="misc.php?mod=faq" title="吾爱破解论坛常见问题解答中心">帮助<span>吾爱破解论坛常见问题解答中心</span></a></li></ul>
<a href="javascript:;" onclick="showWindow('csu_wechat_scan_scan','plugin.php?id=csu_wechat_scan:scan','get',0);return false;" style="float: right;display: inline;margin-top: 5px;margin-left: 3px;margin-right: 3px;">
<img alt="ganzhuweixin" src="../common_images/scan.gif"/>
</a></div>
<ul class="p_pop h_pop" id="mn_Na063_menu" style="display: none"><li><a hidefocus="true" href="home.php?mod=follow&amp;view=follow" style="color: red" target="_blank">关注人的新帖</a></li><li><a hidefocus="true" href="forum.php?mod=guide&amp;view=tech" style="color: blue" target="_blank">技术新帖合集</a></li><li><a hidefocus="true" href="forum.php?mod=guide&amp;view=soft" style="color: green" target="_blank">最新软件合集</a></li><li><a hidefocus="true" href="forum.php?mod=forumdisplay&amp;fid=2&amp;filter=author&amp;orderby=dateline" target="_blank">原创发布新贴</a></li><li><a hidefocus="true" href="forum.php?mod=forumdisplay&amp;fid=5&amp;filter=author&amp;orderby=dateline" target="_blank">脱壳破解新帖</a></li><li><a hidefocus="true" href="forum.php?mod=forumdisplay&amp;fid=65&amp;filter=author&amp;orderby=dateline" target="_blank">移动安全新帖</a></li><li><a hidefocus="true" href="forum.php?mod=forumdisplay&amp;fid=32&amp;filter=author&amp;orderby=dateline" target="_blank">病毒分析新帖</a></li><li><a hidefocus="true" href="forum.php?mod=forumdisplay&amp;fid=59&amp;filter=author&amp;orderby=dateline" target="_blank">软件调试新贴</a></li><li><a hidefocus="true" href="forum.php?mod=forumdisplay&amp;fid=6&amp;filter=author&amp;orderby=dateline" target="_blank">动画发布新帖</a></li><li><a hidefocus="true" href="forum.php?mod=forumdisplay&amp;fid=24&amp;filter=author&amp;orderby=dateline" target="_blank">编程语言新帖</a></li></ul><ul class="p_pop h_pop" id="mn_home_4_menu" style="display: none"><li><a hidefocus="true" href="home.php?mod=spacecp&amp;ac=invite" style="font-weight: bold;color: red" title="通过购买邀请码邀请好友注册论坛">邀请好友注册</a></li></ul><div class="p_pop h_pop" id="mn_userapp_menu" style="display: none"></div><ul class="p_pop h_pop" id="mn_Na678_menu" style="display: none"><li><a hidefocus="true" href="https://down.52pojie.cn/Tools/" target="_blank">Tools</a></li><li><a hidefocus="true" href="https://down.52pojie.cn/Logo/" target="_blank">吾爱破解Logo</a></li><li><a hidefocus="true" href="https://down.52pojie.cn/Logo/Wallpaper/" target="_blank">吾爱破解桌面壁纸</a></li><li><a hidefocus="true" href="https://down.52pojie.cn/%E5%90%BE%E7%88%B1%E7%A0%B4%E8%A7%A3%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B/" target="_blank">吾爱破解视频教程</a></li><li><a hidefocus="true" href="https://down.52pojie.cn/%E5%90%BE%E7%88%B1%E7%A0%B4%E8%A7%A3%E8%AE%BA%E5%9D%9B%E7%B2%BE%E5%8D%8E%E9%9B%86/" target="_blank">吾爱破解论坛精华集</a></li><li><a hidefocus="true" href="https://down.52pojie.cn/Tools/Debuggers/" target="_blank">吾爱破解专用版Ollydbg</a></li></ul><ul class="p_pop h_pop" id="mn_Ndb2c_menu" style="display: none"><li><a hidefocus="true" href="forum.php?mod=forumdisplay&amp;fid=15&amp;filter=typeid&amp;typeid=182&amp;orderby=dateline">处理举报贴</a></li><li><a hidefocus="true" href="forum.php?mod=forumdisplay&amp;fid=72&amp;filter=author&amp;orderby=dateline">处理站务贴</a></li><li><a hidefocus="true" href="forum.php?mod=forumdisplay&amp;fid=66&amp;filter=author&amp;orderby=dateline">处理福利贴</a></li><li><a hidefocus="true" href="forum.php?mod=forumdisplay&amp;fid=10&amp;filter=author&amp;orderby=dateline">处理水区贴</a></li><li><a hidefocus="true" href="forum-23-1.html">办公区</a></li><li><a hidefocus="true" href="forum-34-1.html">证据区</a></li></ul><div class="cl" id="mu">
</div><div class="comiis_nav">
<ul class="nav_ico02">
<li><a href="forum-2-1.html" target="_blank" title="吾爱破解坛友原创作品展示，包含Windows原创工具，也有Android、iOS和Mac OS程序相应的原创程序！"><font color="green">原创发布区</font></a></li>
<li><a href="forum-16-1.html" target="_blank" title="精品软件推荐，软件交流天地，汇集众多精彩评论，热心会员每日更新。找你所需要的，给你我分享的！">精品软件区</a></li>
<li><a href="forum-4-1.html" target="_blank" title="加密解密相关软件发布区，包含最新最全的软件加密解密相关工具，工欲善其事必先利其器！"><font color="green">逆向资源区</font></a></li>
<li><a href="forum-10-1.html" target="_blank" title="据说人滴祖先生活在水里">水漫金山区</a></li>
<li><a href="forum-50-1.html" target="_blank" title="你的计算机又受到病毒的侵扰使你不知所措了？不要着急，让我们一起帮助你解决问题！"><font color="green">病毒救援区</font></a></li>
<li><a href="forum-66-1.html" target="_blank" title="福利资讯、经验分享">福利经验区</a></li>
</ul>
<ul class="nav_ico03">
<li><a href="forum-5-1.html" target="_blank" title="讨论Windows软件脱壳分析、软件逆向分析、代码逆向改造、虚拟机加密分析，也包括Mac OS等其他平台程序逆向分析一切尽在此！"><font color="blue">脱壳破解区</font></a></li>
<li><a href="forum-65-1.html" target="_blank" title="讨论Android软件脱壳分析、Android软件逆向分析、Android系统安全分析、Android软件加密分析，当然iOS等移动程序逆向分析一切尽在此！"><font color="red"><b>移动安全区</b></font></a></li>
<li><a href="forum-32-1.html" target="_blank" title="分析研究病毒木马技术，预防病毒木马，查杀病毒木马"><font color="blue">病毒分析区</font></a></li>
<li><a href="forum-24-1.html" target="_blank" title="学习编程探讨编程技巧，共同分享程序源代码">编程语言区</a></li>
<li><a href="forum-6-1.html" target="_blank" title="软件脱壳、软件汉化、软件逆向相关动画教程，学习心得分享。在这里我们可以携手并进，是我们汲取知识的伟大航路！"><font color="blue">动画发布区</font></a></li>
<li><a href="forum-41-1.html" target="_blank" title="工欲善其事 必先利其器，从这里能找到你想要的利器">安全工具区</a></li>
</ul>
<ul class="nav_ico01">
<li><a href="forum-13-1.html" target="_blank" title="开放注册信息，版块调整公告，站点信息发布，会员违规处理等"><font color="red"><b>站点公告</b></font></a></li>
<li><a href="thread-147931-1-1.html" target="_blank" title="【吾爱破解站点导航帖】 - [让你快速融入吾爱破解大家庭]">站点导航</a></li>
<li><a href="thread-143136-1-1.html" target="_blank" title="吾爱破解站点总版规！"><font color="blue"><b>站点总版规</b></font></a></li>
<li><a href="forum-25-1.html" target="_blank" title="会员、版主、勋章、友情链接申请，发帖前请认真阅读本版规则！本区可以匿名发帖、跟帖相应的申请！">申请专区</a></li>
<li><a href="forum-39-1.html" target="_blank" title="此版块只允许发布招聘和求职相关信息！本区可以匿名发帖，欢迎正规公司前来发布招聘信息！"><font color="green"><b>招聘求职</b></font></a></li>
<li><a href="thread-309877-1-1.html" target="_blank" title=" 版规速读，主要关于如何给自己加违规和如何消违规"><b>违规怎么办</b></a></li>
</ul>
<ul class="nav_ico04" style="width:80px;">
<li><a href="misc.php?mod=faq" target="_blank" title="有什么问题来这里看看吧，这里有你想知道的内容！"><font color="blue"><b>站点帮助</b></font></a></li>
<li><a href="forum-72-1.html" target="_blank" title="如果你对我们有什么意见或者建议，请在此提出">站务处理</a></li>
</ul>
</div>
<div class="cl" id="scbar">
<form action="search.php?searchsubmit=yes" autocomplete="off" id="scbar_form" method="post" onsubmit="searchFocus($('scbar_txt'))" target="_blank">
<input id="scbar_mod" name="mod" type="hidden" value="search"/>
<input name="formhash" type="hidden" value="7f5fdc25"/><input name="srchtype" type="hidden" value="title"/>
<input name="srhfid" type="hidden" value="65"/>
<input name="srhlocality" type="hidden" value="forum::viewthread"/>
<table cellpadding="0" cellspacing="0">
<tr>
<td class="scbar_icon_td"></td>
<td class="scbar_txt_td"><input autocomplete="off" id="scbar_txt" name="srchtxt" speech="" type="text" x-webkit-speech=""/></td>
<td class="scbar_type_td"><a class="xg1" hidefocus="true" href="javascript:;" id="scbar_type" onclick="showMenu(this.id)">搜索</a></td>
<td class="scbar_btn_td"><button class="pn pnc" id="scbar_btn" name="searchsubmit" sc="1" type="submit" value="true"><strong class="xi2">搜索</strong></button></td>
<td class="scbar_hot_td">
<div id="scbar_hot">
<strong class="xw1">热搜: </strong>
<a class="xi2" href="search.php?mod=forum&amp;srchtxt=ctf&amp;formhash=7f5fdc25&amp;searchsubmit=true&amp;source=hotsearch" sc="1" target="_blank">ctf</a>
<a class="xi2" href="search.php?mod=forum&amp;srchtxt=%D0%C2%CA%D6&amp;formhash=7f5fdc25&amp;searchsubmit=true&amp;source=hotsearch" sc="1" target="_blank">新手</a>
<a class="xi2" href="search.php?mod=forum&amp;srchtxt=%CD%D1%BF%C7&amp;formhash=7f5fdc25&amp;searchsubmit=true&amp;source=hotsearch" sc="1" target="_blank">脱壳</a>
<a class="xi2" href="search.php?mod=forum&amp;srchtxt=%BD%CC%B3%CC&amp;formhash=7f5fdc25&amp;searchsubmit=true&amp;source=hotsearch" sc="1" target="_blank">教程</a>
<a class="xi2" href="search.php?mod=forum&amp;srchtxt=Crackme&amp;formhash=7f5fdc25&amp;searchsubmit=true&amp;source=hotsearch" sc="1" target="_blank">Crackme</a>
</div>
</td>
</tr>
</table>
</form>
</div>
<ul class="p_pop" id="scbar_type_menu" style="display: none;"><li><a fid="65" href="javascript:;" rel="curforum">本版</a></li><li><a class="curtype" href="javascript:;" rel="forum">帖子</a></li><li><a href="javascript:;" rel="user">用户</a></li></ul>
</div>
</div>
<link href="https://static.52pojie.cn/highlight/ir-black.min.css" rel="stylesheet"/><link href="source/plugin/zxsq_code/css/code.css" rel="stylesheet"/><link href="https://lib.baomitu.com/tocbot/4.18.0/tocbot.min.css" rel="stylesheet"/><link href="https://static.52pojie.cn/highlight/markdown.min.css" rel="stylesheet"><div id="zxsq-markdown-code-tools" style="display:none"><span class="show">显示代码</span><span class="hide">隐藏代码</span><span class="copy">复制代码</span><span class="copysucc">代码已复制到剪贴板</span></div>
<style>
						a#rewards {
							margin-right: 2px !important;
							padding-top: 3px;
							padding-bottom: 3px;
							padding-left: 10px;
							color: #333;
							
						}
						
						em.showtipex, em.showtipli {
							position: relative;
						}
						em.showtipli {
							right: calc(50% - 50px);
						}
						
					</style>
<ul class="p_pop" id="rewards_menu" style="display: none;">
<li><a href="forum.php?mod=forumdisplay&amp;fid=8&amp;filter=specialtype&amp;specialtype=reward&amp;rewardtype=1" target="_blank" title="帮助坛友解决问题,同时争取论坛积分">挣悬赏</a></li>
<li class="noreward"><a href="home.php?mod=space&amp;do=reward&amp;view=me&amp;flag=1" target="_blank" title="请尽快完结您的悬赏">未完结</a></li>
<li><a href="thread-2083678-1-1.html" target="_blank" title="可按撤销规则回帖申请撤销">撤销悬赏</a></li>
</ul>
<div class="wp" id="wp">
<style id="diy_style" type="text/css"></style>
<div class="area" id="diynavtop"></div>
<div class="bm cl" id="pt">
<div class="z">
<a class="nvhm" href="./" title="首页">吾爱破解 - 52pojie.cn</a><em>»</em><a href="/">网站</a> <em>›</em> <a href="forum.php?gid=1">【 软件安全 】</a> <em>›</em> <a href="forum-65-1.html">『移动安全区』</a> <em>›</em> <a href="thread-2086038-1-1.html">[原创] 从零开始绕过 DexProtector 加固的 Frida 检测（ ...</a>
</div>
</div>
<style>
					.dropbtn{background-color:#0099cb;color:white;padding:2px 6px;font-size:12px;border:none;cursor:pointer;}
					.dropdown{position:relative;display:inline-block;}
					.dropdown-content{display:none;position:absolute;background-color:#f9f9f9;min-width:80px;box-shadow:0px 8px 16px 0px rgba(0,0,0,0.2);}
					.dropdown-content a{color:black;padding:10px;text-decoration:none;display:block;text-align:center;}
					.dropdown-content a:hover{background-color:#d0d1f2;}
					.dropdown:hover .dropdown-content{display:block;}
					.dropdown:hover .dropbtn{background-color:#1b64d7;}
				</style>
<style id="diy_style" type="text/css"></style>
<div class="wp">
<div class="area" id="diy1"></div>
</div>
<div class="wp cl" id="ct">
<div class="pgs mbm cl" id="pgt">
<div class="pgt"></div>
<span class="y pgb" id="visitedforums" onmouseover="$('visitedforums').id = 'visitedforumstmp';this.id = 'visitedforums';showMenu({'ctrlid':this.id,'pos':'34'})"><a href="forum-65-1.html">返回列表</a></span>
<a href="javascript:;" id="newspecial" onclick="showWindow('newthread', 'forum.php?mod=post&amp;action=newthread&amp;fid=65')" onmouseover="$('newspecial').id = 'newspecialtmp';this.id = 'newspecial';showMenu({'ctrlid':this.id})" title="发新帖"><img alt="发新帖" src="../common_images/pn_post.png"/></a><a href="javascript:;" id="post_reply" onclick="showWindow('reply', 'forum.php?mod=post&amp;action=reply&amp;fid=65&amp;tid=2086038')" title="回复"><img alt="回复" src="../common_images/pn_reply.png"/></a>
</div>
<ul class="p_pop" id="newspecial_menu" style="display: none">
<li><a href="forum.php?mod=post&amp;action=newthread&amp;fid=65">发表帖子</a></li><li class="poll"><a href="forum.php?mod=post&amp;action=newthread&amp;fid=65&amp;special=1">发起投票</a></li></ul>
<div class="pl bm" id="postlist">
<table cellpadding="0" cellspacing="0">
<tr>
<td class="pls ptn pbn">
<div class="hm ptn">
<span class="xg1">查看:</span> <span class="xi1">122</span><span class="pipe">|</span><span class="xg1">回复:</span> <span class="xi1">0</span>
</div>
</td>
<td class="plc ptm pbn vwthd">
<div class="y">
<a href="forum.php?mod=redirect&amp;goto=nextoldset&amp;tid=2086038" title="上一主题"><img alt="上一主题" class="vm" src="../common_images/thread-prev.png"/></a>
<a href="forum.php?mod=redirect&amp;goto=nextnewset&amp;tid=2086038" title="下一主题"><img alt="下一主题" class="vm" src="../common_images/thread-next.png"/></a>
</div>
<span class="xg1 side_btn">
<a class="btn_s_close" href="javascript:;" onclick="setcookie('close_leftinfo', 1);location.reload();" title="收起左侧"><img alt="收起左侧" class="vm" src="../common_images/control_l.png"/></a>
</span>
<h1 class="ts">
<a href="forum.php?mod=forumdisplay&amp;fid=65&amp;filter=typeid&amp;typeid=236">[<font color="blue">Android 原创</font>]</a>
<span id="thread_subject">[原创] 从零开始绕过 DexProtector 加固的 Frida 检测（二）-app更新后的检测快速处理</span>
</h1>
<span class="xg1">
<a href="thread-2086038-1-1.html" onclick="return copyThreadUrl(this)">[复制链接]</a>
</span>
</td>
</tr>
</table>
<table cellpadding="0" cellspacing="0" class="ad">
<tr>
<td class="pls">
</td>
<td class="plc">
</td>
</tr>
</table><div id="post_54641369"><table cellpadding="0" cellspacing="0" class="plhin res-postfirst" id="pid54641369" summary="pid54641369">
<tr>
<a name="lastpost"></a><td class="pls" rowspan="2">
<div class="pls cl favatar" id="favatar54641369">
<div class="pi">
<div class="authi"><a class="xw1" href="home.php?mod=space&amp;uid=2315490" rel="nofollow" target="_blank">fyr666</a>
</div>
</div>
<div class="p_pop blk bui card_gender_0" id="userinfo54641369" style="display: none; margin-top: -11px;">
<div class="m z">
<div id="userinfo54641369_ma"></div>
</div>
<div class="i y">
<div>
<strong><a class="xi2" href="home.php?mod=space&amp;uid=2315490" target="_blank">fyr666</a></strong>
<em>当前在线</em>
</div><dt>好友</dt><dd><a class="xi2" href="home.php?mod=space&amp;uid=2315490&amp;do=friend&amp;view=me&amp;from=space" target="_blank">0</a></dd>
<dt>阅读权限</dt><dd>20</dd>
<span style="color:Blue;"><dt>听众</dt><dd><a class="xi2" href="home.php?mod=follow&amp;do=follower&amp;uid=2315490" target="_blank">3</a></dd>
<dt>最后登录</dt><dd>2026-1-12</dd>
<div class="imicn">
<a href="https://fyrlove.github.io/" rel="nofollow noopener" target="_blank" title="查看个人网站"><img alt="查看个人网站" src="../common_images/forumlink.gif"/></a><a href="home.php?mod=space&amp;uid=2315490&amp;do=profile" target="_blank" title="查看详细资料"><img alt="查看详细资料" src="../common_images/userinfo.gif"/></a>
</div>
<div id="avatarfeed"><span id="threadsortswait"></span></div>
</span></div>
</div>
<div>
<div class="avatar" onmouseover="showauthor(this, 'userinfo54641369')"><a class="avtm" href="home.php?mod=space&amp;uid=2315490" rel="nofollow" target="_blank"><img onerror="this.onerror=null;this.src='https://avatar.52pojie.cn/images/noavatar_middle.gif'" src="../common_images/90_avatar_middle.jpg"/></a></div>
</div>
<div class="tns xg2"><table cellpadding="0" cellspacing="0"><th><p><a class="xi2" href="home.php?mod=space&amp;uid=2315490&amp;do=thread&amp;type=thread&amp;view=me&amp;from=space">4</a></p>主题</th><th><p><a class="xi2" href="home.php?mod=space&amp;uid=2315490&amp;do=thread&amp;type=reply&amp;view=me&amp;from=space">25</a></p>回帖</th><td><p><a class="xi2" href="home.php?mod=space&amp;uid=2315490&amp;do=profile">255</a></p>积分</td></table></div>
<p class="side-group"><em><a href="home.php?mod=spacecp&amp;ac=usergroup&amp;gid=11" target="_blank">前途无量</a></em></p>
<p class="side-star"><span id="g_up54641369" onmouseover="showMenu({'ctrlid':this.id, 'pos':'12!'});"><img alt="Rank: 3" src="../common_images/star_level2.gif"/><img alt="Rank: 3" src="../common_images/star_level1.gif"/></span></p>
<div class="tip tip_4" id="g_up54641369_menu" style="display: none;"><div class="tip_horn"></div><div class="tip_c">前途无量, 积分 255, 距离下一级还需 145 积分</div></div>
<dl class="pil cl credit-list">
<span amount="1" class="cr-digest">
<dt>精华</dt>
<dd>1</dd>
</span>
<span amount="6 点" class="cr-ext1">
<dt>威望</dt>
<dd>6 点</dd>
</span>
<span amount="27 点" class="cr-ext6">
<dt>热心值</dt>
<dd>27 点</dd>
</span>
<span amount="0 点" class="cr-ext4">
<dt>悬赏值</dt>
<dd>0 点</dd>
</span>
<span class="cr-follower">
<dt>听众</dt>
<dd><a class="xi2" href="home.php?mod=follow&amp;do=follower&amp;uid=2315490" target="_blank">3</a></dd>
</span>
<span amount="0 点" class="cr-ext3">
<dt>贡献值</dt>
<dd>0 点</dd>
</span>
<span class="cr-ext2">
<dt>吾爱币</dt>
<dd>821 CB</dd>
</span>
<span amount="0 次" class="cr-ext8">
<dt>违规</dt>
<dd>0 次</dd>
</span>
<dt>注册时间</dt>
<dd>2024-11-11</dd>
</dl>
<ul class="xl xl2 o cl">
<li class="addflw">
<a class="xi2" href="home.php?mod=spacecp&amp;ac=follow&amp;op=add&amp;hash=7f5fdc25&amp;fuid=2315490" id="followmod_2315490" onclick="showWindow('followmod', this.href, 'get', 0);" title="收听TA">收听TA</a>
</li>
</ul>
<nav class="toc toc-side relative z-1 transition--300 absolute" id="markdown_toc_54641369"></nav></div>
</td>
<td class="plc">
<div class="pi">
<div class="y" id="fj">
<label class="z">电梯直达</label>
<input class="px p_fre z" onkeydown="if(event.keyCode==13) {window.location=$('fj_btn').href;return false;}" onkeyup="$('fj_btn').href='forum.php?mod=redirect&amp;ptid=2086038&amp;authorid=0&amp;postno='+this.value" size="2" title="跳转到指定楼层" type="text"/>
<a class="z" href="javascript:;" id="fj_btn" title="跳转到指定楼层"><img alt="跳转到指定楼层" class="vm" src="../common_images/fj_btn.png"/></a>
</div>
<strong>
<a href="thread-2086038-1-1.html" id="postnum54641369" onclick="setCopy(this.href, '帖子地址复制成功');return false;">
<font color="red"><b>楼主</b></font></a>
</strong>
<div class="pti">
<div class="pdbt">
</div>
<div class="authi">
<img class="authicn vm" id="authicon54641369" src="../common_images/online_member.gif"/>
<span class="res-author"><a class="xi2" href="home.php?mod=space&amp;uid=2315490" target="_blank">fyr666</a>
</span><em id="authorposton54641369"><span class="poston">发表于</span> 2026-1-12 17:08</em>
<span class="pipe">|</span>
<a href="forum.php?mod=viewthread&amp;tid=2086038&amp;page=1&amp;authorid=2315490" rel="nofollow">只看该作者</a>
<span class="none"><img alt="回帖奖励" class="vm" src="../common_images/arw_r.gif"/></span>
<span class="pipe show">|</span><a class="show" href="forum.php?mod=viewthread&amp;tid=2086038&amp;extra=page%3D1&amp;ordertype=1" rel="nofollow">倒序浏览</a>
</div>
</div>
</div><div class="pct"><style type="text/css">.pcb{margin-right:0}</style><div class="pcb">
<div class="t_fsz">
<table cellpadding="0" cellspacing="0"><tr><td class="t_f" id="postmessage_54641369">
<div class="parsedown-markdown"><h2 id="54641369_从零开始绕过-dexprotector-加固的-frida-检测（二）">从零开始绕过 DexProtector 加固的 Frida 检测（二）</h2>
<h3 id="54641369_app版本更新了，如何快速进行处理？如何使用frida-server实现过检测？">app版本更新了，如何快速进行处理？如何使用frida-server实现过检测？</h3>
<p>（本文由 id：小佳、fyrlove、roysue 共同完成）</p>
<p>这一篇可以看成是《 <a href="https://www.52pojie.cn/thread-2074484-1-1.html" rel="noopener noreferrer nofollow" target="_blank">从零开始绕过 DexProtector 加固的 Frida 检测</a>》的续集：<br/>
上一版文章里，我们从 0 开始，一路跟到 DexProtector 的匿名段，把 Frida 的几类检测点（maps / 线程监控 / inline hook / SHA256 校验等）一一打通，在当时的版本上实现了比较完整的一套绕过方案。</p>
<p>大家如果跟着实现了，可以发现，过掉检测后，会提示更新，这也是现实开发/对抗的真实场景：  </p>
<blockquote>
<p><strong>App 隔三差五发个小版本更新，壳还是 DexProtector，<br/>
但 so 结构、偏移、匿名段位置都变了――旧脚本直接崩，<br/>
要不要从头再逆一次？</strong></p>
</blockquote>
<p>这篇文章要解决的，就是这个“日常但很致命”的问题：</p>
<blockquote>
<p><strong>当 app 小版本更新后，怎么在不推倒重来的前提下，<br/>
快速把上一版已经验证过的绕过思路迁移过来？</strong></p>
</blockquote>
<p>然后，顺着这个场景，我们再往前迈一步，目前都使用了开源模块来完成过检测，这里我们后面会魔改frida-server来完成过检测：</p>
<ul>
<li>自己编译一份 <strong>固定版本的 frida 16.5.2</strong></li>
<li>在手机上用「魔改版 frida-server」直接替换原版的firda-server，<br/>
在 <strong>不依赖 Zygisk Frida Gadget 模块</strong> 的前提下，通过当前样本的检测</li>
</ul>
<p>所以整篇文章分成两大部分：</p>
<ol>
<li><strong>第一部分：快速修改更新后的脚本</strong>  
<ul>
<li>换新样本后，如何利用 dlopen + 指针解引用 + 匿名段 dump，重新找到 DexProtector 的真实执行入口  </li>
<li>怎么用上一个版本已经踩过的“特征”（比如 <code>C8628052</code> / <code>28108052</code> 这些常量、pthread_create 调度点、inline hook 分发函数等），<strong>批量迁移偏移</strong>，而不是重新“看一遍全图”</li>
</ul></li>
<li><strong>第二部分：自己编译 frida-server，并用魔改版过检测</strong>  
<ul>
<li>从零安装 Ubuntu 22.04.5 虚拟机、配置共享文件夹  </li>
<li>搭建 Frida 16.5.2 的完整编译环境（NDK / Node / 依赖）  </li>
<li>基于开源项目 <code>ajeossida</code> 固定 Frida 版本为 16.5.2，改名为自定义的 <code>fyrrida</code>，并输出适配 Android arm64 的 server  </li>
<li>实机上用 <strong>魔改后的 frida-server</strong> 替换官方版，配合前文脚本，实测通过 DexProtector 检测</li>
</ul></li>
</ol>
<p>为保证结论可复现、可迁移，所有实验都在同一套环境下完成：</p>
<ul>
<li>设备：Nexus 5X  </li>
<li>系统：LineageOS 21  </li>
<li>Root &amp; 模块：Magisk 29.0.0 + LSPosed  </li>
<li>Frida：Zygisk Frida Gadget 开源模块（<a href="https://github.com/sucsand/sucsand" rel="noopener noreferrer nofollow" target="_blank">https://github.com/sucsand/sucsand</a>）  </li>
<li>Frida 版本：Frida Server 16.5.2  </li>
<li>魔改frida-server: fyrrida-server</li>
</ul>
<p><strong>合规声明：</strong></p>
<ul>
<li>文章仅用于安全研究与对抗评估；</li>
<li>目的是帮助甲方团队识别加固薄弱点，完善自检和回归流程；</li>
<li>不针对任何具体业务做攻击落地；</li>
<li>不提供“一键利用第三方应用”的脚本。</li>
</ul>
<hr/>
<p><strong>适合谁看？</strong></p>
<ul>
<li>已经看过 / 跑过上一篇，基本了解 DexProtector 这一版的检测策略</li>
<li>想把自己手里的 frida 从“拿来主义”升级到“可定制、可迭代”的同学</li>
</ul>
<p><strong>不适合谁？</strong></p>
<ul>
<li>想找一份“一键通杀脚本”直接上线的，这篇不提供  </li>
<li>完全不熟悉 Android / so / Frida 逆向环境的，建议先把基础环境、工具用法打通，再回来会更顺</li>
</ul>
<p><strong>阅读顺序建议：</strong><br/>
本篇所有操作，都是在上一篇文章的基础上做“版本升级迁移”。如果你还没看过第一篇，建议先看完再回来：</p>
<ul>
<li>上一篇基础篇：<br/>
<a href="https://www.52pojie.cn/thread-2074484-1-1.html" rel="noopener noreferrer nofollow" target="_blank">从零开始绕过 DexProtector 加固的 Frida 检测</a></li>
</ul>
<p>下面从样本更新开始，一步步走一遍：先看旧脚本在新版本上是怎么崩的，再带着这些“已知检测点”，去新版 so 里做定位和迁移。</p>
<h2 id="54641369_第一部分：快速修改更新后的脚本（版本升级迁移）">第一部分：快速修改更新后的脚本（版本升级迁移）</h2>
<p>这一部分的目标很简单：<strong>在不推倒重来的前提下，把旧脚本迁移到新版本上继续可用</strong>。<br/>
核心思路是：</p>
<blockquote>
<p>先定位“新的真实执行入口”，再用“老版本已知特征”去对齐“新版本偏移”。</p>
</blockquote>
<h3 id="54641369_1.-更新样本与准备工作">1. 更新样本与准备工作</h3>
<h4 id="54641369_1.1-使用上一篇文章中的完整脚本进行测试">1.1 使用上一篇文章中的完整脚本进行测试</h4>
<p>更新后样本：kaiyue610.apks，放在附件和文章结尾。</p>
<p>这里我没有先去看 so，而是直接沿用上一篇已经验证过的完整脚本，先执行一次，看它“死在哪里”。这一步有两个目的：</p>
<ol>
<li>快速验证：<strong>旧思路是否整体仍然成立</strong>（大概率成立，除非壳版本跨度非常大）  </li>
<li>给出一个“崩溃点”，方便后面在新 so 里对照定位</li>
</ol>
<p>端口转发：<br/>
<ignore_js_op>
<img aid="2826734" class="zoom" id="aimg_2826734" inpost="1" src="../common_images/164836ek6kf56kppf5fptz.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826734_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_3.png</strong> <em class="xg1">(89.33 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjczNHxhN2Q3ZDdjMXwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:48 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
</p>
<p>执行结果：<br/>
<ignore_js_op>
<img aid="2826735" class="zoom" id="aimg_2826735" inpost="1" src="../common_images/164839m22zcuift3oueemo.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826735_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_4.png</strong> <em class="xg1">(141.18 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjczNXw3ZGIzMTA4MnwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:48 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
<br/>
不出意外的崩溃了。从日志可以看到是典型的“地址无效导致崩溃”。从对抗经验上，这往往意味着：</p>
<ul>
<li>整体检测链路还在</li>
<li>但<strong>关键函数 / 检测逻辑的偏移已经变化</strong>，脚本打到了一块错误的内存区域</li>
</ul>
<p>接下来根据 610 版本的 apk，获取一下新版本的 so，并重新 dump 匿名段上的 so。</p>
<h4 id="54641369_1.2-获取新版本的专属-so（libdexprotector.so）">1.2 获取新版本的专属 so（libdexprotector.so）</h4>
<p>第一步还是老流程：先拿到 DexProtector 自己的壳 so，也就是 <code>libdexprotector.so</code>。<br/>
这个so在split_config.arm64_v8a.apk里面，安装包里解压出来有，再给它解压就得到libdexprotector.so<br/>
把这个新版本的so用ida打开，可以看到:</p>
<pre><code class="language-js">jint JNI_OnLoad(JavaVM *vm, void *reserved)
{
  int v3; 
  if ( dword_B840 )
    return -dword_B840;
  v3 = off_B848(vm, 0);
  off_B848 = 0;
  if ( v3 )
    return -v3;
  else
    return 65540;
}</code></pre>
<p>这里的指针函数变成了off_B848，而上个版本这里是off_C838。</p>
<p>这一步很关键：</p>
<p>JNI_OnLoad 本身没什么花活，但它帮你给出了“下一步真正执行逻辑”的指针</p>
<p>一旦指针位置变了（off_C838 → off_B848），意味着后面所有“基于旧偏移”的脚本都要跟着调整</p>
<h4 id="54641369_1.3-dump内存段上的so">1.3 dump内存段上的so</h4>
<p>这一步和上一篇完全一样：<br/>
利用 __loader_android_dlopen_ext 的 hook，把匿名段里的真正执行代码 dump 出来。</p>
<p>具体执行过程，请参考上一篇文章，这里不再赘述。<br/>
<a href="https://www.52pojie.cn/thread-2074484-1-1.html
" rel="noopener noreferrer nofollow" target="_blank">从零开始绕过DexProtector加固的Frida检测</a></p>
<p>这里我们只关心：新版本的匿名段 so 也已经拿到了，接下来要重新找“真实执行入口”。</p>
<h4 id="54641369_1.4-用-dlopen-+-指针解引用找到真实执行的函数">1.4 用 dlopen + 指针解引用找到真实执行的函数</h4>
<pre><code class="language-js">function hook_dlopen() {
    var android_dlopen_ext = Module.findExportByName(null, "__loader_android_dlopen_ext")
    Interceptor.attach(android_dlopen_ext, {
        onEnter: function (args) {
            var pathptr = args[0];
            if (pathptr !== undefined &amp;&amp; pathptr != null) {
                var path = pathptr.readCString();
                console.log(path)
                if (path.indexOf("libdexprotector.so") !== -1) {
                    this.match = true
                }
            }
        },
        onLeave: function () {
            if (this.match) {
                let libdexprotector = Process.findModuleByName("libdexprotector.so")
                var nativePointer = libdexprotector.base.add(0xB848).readPointer();
                var rangeDetails = Process.findRangeByAddress(nativePointer);
                // 段开始和结束
                console.log(rangeDetails.base)
                console.log(rangeDetails.base.add(rangeDetails.size))
                // 开始位置
                console.log("真实的执行函数 =&gt; "+nativePointer.sub(rangeDetails.base))
                Thread.sleep(50)
            }
        }
    })
}

hook_dlopen()</code></pre>
<p>执行结果：</p>
<pre><code class="language-js">/system/framework/oat/arm64/org.apache.http.legacy.odex
/data/app/~~Z8NVPZHkUQBOvE5wdUvwlw==/com.Hyatt.hyt-h-4z3JSgsyZQX5dyLoDPUg==/oat/arm64/base.odex
/data/app/~~Z8NVPZHkUQBOvE5wdUvwlw==/com.Hyatt.hyt-h-4z3JSgsyZQX5dyLoDPUg==/split_config.arm64_v8a.apk!/lib/arm64-v8a/libalice.so
/data/app/~~Z8NVPZHkUQBOvE5wdUvwlw==/com.Hyatt.hyt-h-4z3JSgsyZQX5dyLoDPUg==/split_config.arm64_v8a.apk!/lib/arm64-v8a/libdpboot.so
/data/app/~~Z8NVPZHkUQBOvE5wdUvwlw==/com.Hyatt.hyt-h-4z3JSgsyZQX5dyLoDPUg==/split_config.arm64_v8a.apk!/lib/arm64-v8a/libdexprotector.so
0x75ffc04000
0x75ffc80000
真实的执行函数 =&gt; 0x4ec38</code></pre>
<p>这里有几个信息点：</p>
<p>libdexprotector.so 还是正常通过 __loader_android_dlopen_ext 加载</p>
<p>off_B848 指向的地址，仍然落在一个匿名段范围内（0x75ffc04000 ~ 0x75ffc80000）</p>
<p>真正执行逻辑的入口偏移变成了 0x4ec38</p>
<p>小结一下这一节：</p>
<ul>
<li>旧脚本崩溃，让我们确认“检测逻辑还在”；</li>
<li>新指针 off_B848 + 匿名段 dump，让我们拿到了新版本的真正起点（0x4ec38）。</li>
<li>下面所有迁移工作，都是围绕这个入口展开的。</li>
</ul>
<h4 id="54641369_1.5-使用ida对dump的so进行修复">1.5 使用ida对dump的so进行修复</h4>
<p>修复方法和上一篇一样：把 dump 出来的匿名段 so，按 text 段对齐、修复重定位，尽量恢复出一个“可读”的 IDA 工程。</p>
<p>这里是我已经修复之后的，修复手法，请参考上一篇文章。<br/>
<ignore_js_op>
<img aid="2826736" class="zoom" id="aimg_2826736" inpost="1" src="../common_images/164842jlszjpjyss15z1hq.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826736_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_5.png</strong> <em class="xg1">(157.38 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjczNnw2ZDZmMGVlNHwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:48 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
</p>
<p>到这里，准备工作就完成了。</p>
<p>剩下的，就是围绕新的入口偏移 0x4ec38，去重新定位各类检测点：pthread_create、inline hook 分发、SHA-256 校验、maps 检测等。</p>
<h3 id="54641369_02.思考，针对更新如何进行处理">02.思考，针对更新如何进行处理</h3>
<h4 id="54641369_2.1-根据上次完成的脚本，来进行思考，分析检测特征有哪些">2.1 根据上次完成的脚本，来进行思考，分析检测特征有哪些</h4>
<ul>
<li>
<p>特征一、线程创建，线程检测（phtread_create是第一个特征）<br/>
这一块是最典型的“监控线程 + 检测循环”逻辑。上一版里，我们直接对几个关键调用点做了 ret：</p>
<pre><code class="language-js">retFunc(libanon.base.add(0x5A708))
retFunc(libanon.base.add(0x5BE28))
retFunc(libanon.base.add(0x5D1A4))
retFunc(libanon.base.add(0x5D710))</code></pre>
<p>这里本质上是在阻断监控线程的创建，让它根本跑不起来。</p>
</li>
<li>
<p>特征二、inline hook<br/>
这里有两类，一类是“看 LR 决定走哪段逻辑”的分发函数：</p>
<pre><code class="language-js">            var hash_crc = {
                "0x4f5a4" : "0x8A810",
                "0x4f6cc" : "0x8A810",
                "0x5c494" : "0x8AB20"
            }
            Interceptor.attach(libanon.base.add(0x161E8),{
                onEnter:function(args){
                    console.log("sub_161E8 enter",this.context.lr.sub(libanon.base))
                    this.lr = this.context.lr.sub(libanon.base)
                },onLeave:function(ret){
                    if(hash_crc[this.lr.toString()]){
                        ret.replace(libanon.base.add(hash_crc[this.lr.toString()]).readU64())
                        console.log("sub_161E8 leave",ret)
                    }                            
                }
            })</code></pre>
<p>另一类是“利用指针替换”的方式，把原来的校验函数指向我们想要的地址：</p>
<pre><code class="language-js">Interceptor.attach(libanon.base.add(0x304A8), {
                onEnter: function (args) {
                       //这里是sha256
                    if (args[1].toString() === libanon.base.toString()) {
                        var rangeDetails = Process.findRangeByAddress(args[0]);
                        console.log("onEnter  0x304A8 ",args[0],args[1],args[2],"base ",rangeDetails.base)
                        args[1] = origin
                        console.log("[0x304A8] 替换成功")
                    }
                }
            })</code></pre>
<p>这两类逻辑，有一个共同点：</p>
<blockquote>
<p>它们本身不承担“检测计算”，而是“调度 / 分发 / 接线”，属于非常稳定的结构。<br/>
版本更新时，里面被调用的具体函数地址会变，但“整体骨架 + 控制方式”大概率不变。</p>
</blockquote>
</li>
<li>
<p>特征三、maps检测<br/>
通过上一篇文章的分析，可以知道这个函数返回的结果是790 </p>
<pre><code class="language-js">            //hook_maps
            Interceptor.attach(libanon.base.add(0x61974),{ 
                onEnter: function(){
                    this.lr = this.context.lr.sub(libanon.base)
                },
                onLeave: function(retval){
                    console.log("0x61974 =&gt; ",retval.toInt32()," lr =&gt; ",this.lr);
                    retval.replace(0);
                }
            })</code></pre>
<p>在ida中定位到0x61974，查看790，按tab，查看汇编，这个W8, #0x316，基本是不会变化的。</p>
<pre><code>ROM:0000000000061C84                 MOV             W8, #0x316</code></pre>
<p>也就是</p>
<pre><code>C8628052</code></pre>
<p>
<ignore_js_op>
<img aid="2826732" class="zoom" id="aimg_2826732" inpost="1" src="../common_images/164829cnkz1in1zps0tsdn.png" width="1076"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826732_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_1.png</strong> <em class="xg1">(189.42 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjczMnwxZDNkNGU3Y3wxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:48 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
<br/>
<ignore_js_op>
<img aid="2826760" class="zoom" id="aimg_2826760" inpost="1" src="../common_images/164938yffn8npvfn1pezea.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826760_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img.png</strong> <em class="xg1">(95.58 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc2MHwwODEwZDkzNXwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:49 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
</p>
</li>
</ul>
<p>所以，总体上，我们需要处理的检测有这几类：</p>
<ol>
<li>线程创建 / 监控线程（pthread_create）</li>
<li>inline hook 分发函数（通过 LR 决定后续逻辑）</li>
<li>SHA-256 / CRC 等校验逻辑（通过指针参数 / 填充来替换）</li>
<li>maps 检测（通过固定常量快速定位）</li>
</ol>
<p>接下来就是实战部分：怎么把这些“共性特征”迁移到新版本上。</p>
<h3 id="54641369_03.实际操作：基于“入口-+-特征”的偏移迁移">03.实际操作：基于“入口 + 特征”的偏移迁移</h3>
<p>app小版本更新，检测点很大概率是不会发生变化的。所以按思路，拿到新dump下来的so之后，顺序进行分析。<br/>
上面已经拿到真实的执行函数 =&gt; 0x4ec38</p>
<h4 id="54641369_3.1-顺序查找，定位新的inline-hook，并修改代码">3.1 顺序查找，定位新的inline hook，并修改代码</h4>
<p>在ida中打开新的libanon.so，按G，跳转到0x4ec38。<br/>
<ignore_js_op>
<img aid="2826737" class="zoom" id="aimg_2826737" inpost="1" src="../common_images/164844vfprdungnl2plwcg.png" width="1010"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826737_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_6.png</strong> <em class="xg1">(157.35 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjczN3xiYzQ1YTM4OXwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:48 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
<br/>
从这里开始，顺藤摸瓜往下点：点击第一个函数sub_4ED54，进去后，结果如下：<br/>
<ignore_js_op>
<img aid="2826738" class="zoom" id="aimg_2826738" inpost="1" src="../common_images/164847i2qcb85c6d0bjcu5.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826738_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_7.png</strong> <em class="xg1">(220.78 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjczOHxiMmE0MWMxZXwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:48 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
<br/>
按之前文章分析，可以知道，新的so中，最关键的函数就是sub_4F508了。</p>
<p>进入sub_4F508了之后，顺序进行分析，很快就能找到做inline hook的地方，sub_165F0：<br/>
<ignore_js_op>
<img aid="2826739" class="zoom" id="aimg_2826739" inpost="1" src="../common_images/164849pvr453arpft55u33.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826739_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_8.png</strong> <em class="xg1">(145.07 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjczOXxkMTYzOTgwNnwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:48 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
<br/>
引用查找sub_165F0，找到需要定位的lr，完成后的代码是：</p>
<pre><code class="language-js">                var hash_crc = {
                    "0x4f858": "0x8AE20",
                    "0x4f980": "0x8AE20",
                    "0x53c58": "0x8AF00",
                    "0x5c8f0": "0x8B140"
                }
                Interceptor.attach(libanon.base.add(0x165F0),{
                    onEnter:function(args){
                        console.log("0x165F0 enter",this.context.lr.sub(libanon.base))
                        this.lr = this.context.lr.sub(libanon.base)
                    },onLeave:function(ret){
                        if(hash_crc[this.lr.toString()]){
                            ret.replace(libanon.base.add(hash_crc[this.lr.toString()]).readU64())
                            console.log("0x165F0 leave",ret)
                        }                            
                    }
                })</code></pre>
<p>到这里，第一步“顺序查找 + inline hook 迁移”就完成了：</p>
<ul>
<li>老版本中的 sub_161E8 → 新版本中的 sub_165F0</li>
<li>LR 与目标偏移的映射关系重新整理成了新版的 hash_crc</li>
</ul>
<h4 id="54641369_3.2-快速定位sha256的位置（特征字节法）">3.2 快速定位sha256的位置（特征字节法）</h4>
<p>使用010editor，ctrl+f，进行搜索</p>
<pre><code>6560045e5040115e</code></pre>
<p>搜索结果，右键复制地址：<br/>
<ignore_js_op>
<img aid="2826740" class="zoom" id="aimg_2826740" inpost="1" src="../common_images/164852jd63xdpg2z4dlxdp.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826740_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_9.png</strong> <em class="xg1">(207.3 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc0MHw2MGNkYTRhZHwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:48 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
<br/>
到ida中跳转地址，直接就定位到了sha256的函数，sub_308B0：<br/>
<ignore_js_op>
<img aid="2826741" class="zoom" id="aimg_2826741" inpost="1" src="../common_images/164854mp7mb3gxpgx2txtp.png" width="900"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826741_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_10.png</strong> <em class="xg1">(272.19 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc0MXwyODk5OWY0NnwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:48 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
</p>
<p>修改之后的代码是：</p>
<pre><code class="language-js">                Interceptor.attach(libanon.base.add(0x308B0), {
                    onEnter: function (args) {
                        if (args[1].toString() === libanon.base.toString()) {
                            var rangeDetails = Process.findRangeByAddress(args[0]);
                            console.log("onEnter  0x308B0 ",args[0],args[1],args[2],"base ",rangeDetails.base)
                            args[1] = origin
                            console.log("[0x308B0] 替换成功")
                        }
                    }
                })</code></pre>
<p>执行一下脚本，拿到地址是0x7a8b0：</p>
<pre><code>0x165F0 enter 0x4f858
0x165F0 leave 0x832d39a094055b4f
onEnter  0x308B0  0x7fc00018c0 0x79ee96c000 0x7a8b0 base  0x7fbf80b000
[0x308B0] 替换成功</code></pre>
<p>使用0x7a8b0，更新脚本：</p>
<pre><code class="language-js">var origin
var size=0x7a8b0</code></pre>
<p>这一步完成后，新版的 SHA-256 校验逻辑也已经被“接管”，后续就不会再因为 hash 校验失败而崩溃。</p>
<h4 id="54641369_3.3-使用特征常量快速定位新的-maps-检测">3.3 使用特征常量快速定位新的 maps 检测</h4>
<p>使用之前的C8628052，在010editor中进行搜索：<br/>
<ignore_js_op>
<img aid="2826742" class="zoom" id="aimg_2826742" inpost="1" src="../common_images/164857bs1aorko1nprafxl.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826742_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_11.png</strong> <em class="xg1">(178.51 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc0Mnw3OGEyYjBkYXwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:48 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
<br/>
直接就搜索到了，右键复制地址，然后去ida中跳转地址，直接就定位上了，sub_61FBC：<br/>
<ignore_js_op>
<img aid="2826743" class="zoom" id="aimg_2826743" inpost="1" src="../common_images/164859qow2j8mjnw2k2wnw.png" width="1058"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826743_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_12.png</strong> <em class="xg1">(232.83 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc0M3xlYzUzNmRhYXwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:48 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
<br/>
修改之后的代码是：</p>
<pre><code class="language-js">                //hook_maps
                Interceptor.attach(libanon.base.add(0x61FBC),{ 
                    onEnter: function(){
                        this.lr = this.context.lr.sub(libanon.base)
                    },
                    onLeave: function(retval){

                        console.log("0x61FBC =&gt; ",retval.toInt32()," lr =&gt; ",this.lr);
                        retval.replace(0);
                    }
                })</code></pre>
<p>通过这一步，可以验证两个结论：</p>
<ul>
<li>DexProtector 的 maps 检测逻辑整体没有被删除，只是偏移发生了变化</li>
<li>“固定返回 0x316 / 790” 这种做法，在多版本之间具有很强的可迁移性，非常适合拿来做锚点</li>
</ul>
<h4 id="54641369_3.4-接下来是最后一个，pthread_create监控线程">3.4 接下来是最后一个，pthread_create监控线程</h4>
<p>在010editor中搜索：28108052<br/>
<ignore_js_op>
<img aid="2826744" class="zoom" id="aimg_2826744" inpost="1" src="../common_images/164901j1q2otmtijlt09mz.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826744_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_13.png</strong> <em class="xg1">(135.42 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc0NHxjODQ5ZWMxZHwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:49 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
<br/>
复制地址，到ida跳转地址：<br/>
<ignore_js_op>
<img aid="2826745" class="zoom" id="aimg_2826745" inpost="1" src="../common_images/164904vaq2ayodkkr274gg.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826745_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_14.png</strong> <em class="xg1">(113.6 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc0NXxhM2EwNWFkYXwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:49 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
<br/>
定位到了sub_5AB20，按x查找引用：<br/>
<ignore_js_op>
<img aid="2826746" class="zoom" id="aimg_2826746" inpost="1" src="../common_images/164906hhmb2k23smzk0vmi.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826746_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_15.png</strong> <em class="xg1">(53.07 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc0NnxlNzVmZWZmNHwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:49 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
<br/>
跳转后，找到了pthread_create:<br/>
<ignore_js_op>
<img aid="2826747" class="zoom" id="aimg_2826747" inpost="1" src="../common_images/164908xh31hb75bm71zby9.png" width="828"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826747_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_16.png</strong> <em class="xg1">(102.87 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc0N3xjYjUzYmE2NnwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:49 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
<br/>
基本上可以确定这个sub_7A860这个函数就是pthread_create了，找它全部调用的地方全部ret掉。</p>
<p>在sub_7A860按x，查找所有引用：<br/>
<ignore_js_op>
<img aid="2826748" class="zoom" id="aimg_2826748" inpost="1" src="../common_images/164911k8lc18u5d11tnjtn.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826748_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_17.png</strong> <em class="xg1">(111.07 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc0OHxjOWU5NzRkZXwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:49 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
<br/>
然后修改之前的代码：</p>
<pre><code class="language-js">                retFunc(libanon.base.add(0x5AB20))
                retFunc(libanon.base.add(0x5C280))
                retFunc(libanon.base.add(0x5D5FC))
                retFunc(libanon.base.add(0x5DB68))</code></pre>
<p>到这里，新版本的“监控线程创建”也已经全部封死。</p>
<h3 id="54641369_所有检测点的新版本修改完毕">所有检测点的新版本修改完毕</h3>
<p>执行新的代码：</p>
<pre><code class="language-shell">frida -H 127.0.0.1:9999 -F -l hook_dexprotectB848.js</code></pre>
<p>执行结果，成功过掉了610版本的检测：<br/>
<ignore_js_op>
<img aid="2826749" class="zoom" id="aimg_2826749" inpost="1" src="../common_images/164913gcrcf6hgbh5hzzft.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826749_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_18.png</strong> <em class="xg1">(81.93 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc0OXw4ZjkxZTFmZHwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:49 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
<br/>
<ignore_js_op>
<img aid="2826750" class="zoom" id="aimg_2826750" inpost="1" src="../common_images/164915g0qdedmp5too0bzf.png" width="964"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826750_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_19.png</strong> <em class="xg1">(138.41 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc1MHw4Y2UxMTkzZHwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:49 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
</p>
<h3 id="54641369_4.-把这一套变成你的“版本升级-sop”">4. 把这一套变成你的“版本升级 SOP”</h3>
<p>这一部分，把版本升级后，如果快速处理脚本更新做了一个详细的拆解。可以总结成一套反复可用的流程。<br/>
步骤如下：</p>
<ol>
<li>先跑一次旧脚本，看看"死在哪儿"</li>
<li>拿到新版本崩溃的so，并定位新的入口</li>
<li>dump新的匿名段so，锁定新的真实入口</li>
<li>根据新的入口在 IDA 里顺序查找，替换 Frida 脚本里的偏移</li>
<li>用“特征常量 + 010 Editor”快速锚定新检测点</li>
</ol>
<p>以上就完成了版本更新后，快速定位修改脚本并过检测的目的。下面，开始详细分析字符串，还原分析过程。</p>
<h4 id="54641369_5.-通过打印日志分析字符串">5. 通过打印日志分析字符串</h4>
<p>这一节算是一个“预告性质”的内容：<br/>
当前样本在绕过后，继续打印了一些字符串日志，可以看出 DexProtector 在做更多维度的环境检测。</p>
<pre><code class="language-js">[0x40A68] XposedBridge  lr =&gt;  0x65e28
[0x40A68] xposed/dummy/XResourcesSuperClass  lr =&gt;  0x65a54
[0x40A68] /proc/self/status  lr =&gt;  0x5a820
[0x40A68] dalvik/system/VMDebug  lr =&gt;  0x5d770
[0x40A68] isDebuggerConnected  lr =&gt;  0x5d7b8
[0x40A68] ()Z  lr =&gt;  0x5d7d4
[0x40A68] /proc/self/maps  lr =&gt;  0x3b68c
[0x40A68] libart.so  lr =&gt;  0x5d8c4
[0x40A68] libriru  lr =&gt;  0x61648
[0x40A68] .magisk  lr =&gt;  0x61660
[0x40A68] zygisk  lr =&gt;  0x616b8</code></pre>
<p>在输出中可以看到有zygisk字符串，选zygisk，在ida中去查看一下，<br/>
<ignore_js_op>
<img aid="2826751" class="zoom" id="aimg_2826751" inpost="1" src="../common_images/164917kzcaov6a6jppocaw.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826751_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_20.png</strong> <em class="xg1">(191.97 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc1MXwzODdiYmNlNHwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:49 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
<br/>
一般来说，有解密就有比较。分别查看sub_12374和sub_120B0之后，可以知道sub_120B0就是用来做比较的:</p>
<pre><code class="language-c">__int64 __fastcall sub_120B0(unsigned __int8 *a1, unsigned __int8 *a2)
{
  int v2; // w9
  unsigned int v3; // w8

  while ( 1 )
  {
    v2 = *a1;
    v3 = v2 - *a2;
    if ( v3 )
      break;
    ++a2;
    ++a1;
    if ( !v2 )
      return 0;
  }
  return v3;
}</code></pre>
<p>可以hook看一下：</p>
<pre><code class="language-js">                Interceptor.attach(libanon.base.add(0x120B0),{ 
                    onEnter: function(args){
                        this.lr = this.context.lr.sub(libanon.base)
                        console.log("0x120B0 =&gt; "," lr =&gt; ",this.lr,args[0].readCString(),args[1].readCString());
                    },
                    onLeave: function(retval){

                    }
                })</code></pre>
<p>运行结果，多输出了很多的字符串：</p>
<pre><code class="language-js">0x120B0 =&gt;   lr =&gt;  0xa6f9560c blog.so blog.so
0x120B0 =&gt;   lr =&gt;  0xa6f9560c log.so log.so
0x120B0 =&gt;   lr =&gt;  0xa6f9560c og.so og.so
0x120B0 =&gt;   lr =&gt;  0xa6f9560c g.so g.so
0x120B0 =&gt;   lr =&gt;  0xa6f9560c .so .so
0x120B0 =&gt;   lr =&gt;  0xa6f9560c so so
0x120B0 =&gt;   lr =&gt;  0xa6f9560c o o
0x120B0 =&gt;   lr =&gt;  0xa6f9560c  
0x120B0 =&gt;   lr =&gt;  0x3abfc __android_log_btwrite __android_log_btwrite
0x120B0 =&gt;   lr =&gt;  0xa6f9560c _android_log_btwrite _android_log_btwrite
0x120B0 =&gt;   lr =&gt;  0xa6f9560c android_log_btwrite android_log_btwrite
0x120B0 =&gt;   lr =&gt;  0xa6f9560c ndroid_log_btwrite ndroid_log_btwrite
0x120B0 =&gt;   lr =&gt;  0xa6f9560c droid_log_btwrite droid_log_btwrite
0x120B0 =&gt;   lr =&gt;  0xa6f9560c roid_log_btwrite roid_log_btwrite
0x120B0 =&gt;   lr =&gt;  0xa6f9560c oid_log_btwrite oid_log_btwrite
0x120B0 =&gt;   lr =&gt;  0xa6f9560c id_log_btwrite id_log_btwrite
0x120B0 =&gt;   lr =&gt;  0xa6f9560c d_log_btwrite d_log_btwrite
0x120B0 =&gt;   lr =&gt;  0xa6f9560c _log_btwrite _log_btwrite
0x120B0 =&gt;   lr =&gt;  0xa6f9560c log_btwrite log_btwrite
0x120B0 =&gt;   lr =&gt;  0xa6f9560c og_btwrite og_btwrite
0x120B0 =&gt;   lr =&gt;  0xa6f9560c g_btwrite g_btwrite
0x120B0 =&gt;   lr =&gt;  0xa6f9560c _btwrite _btwrite
0x120B0 =&gt;   lr =&gt;  0xa6f9560c btwrite btwrite
0x120B0 =&gt;   lr =&gt;  0xa6f9560c twrite twrite
0x120B0 =&gt;   lr =&gt;  0xa6f9560c write write
0x120B0 =&gt;   lr =&gt;  0xa6f9560c rite rite
0x120B0 =&gt;   lr =&gt;  0xa6f9560c ite ite
0x120B0 =&gt;   lr =&gt;  0xa6f9560c te te
0x120B0 =&gt;   lr =&gt;  0xa6f9560c e e
0x120B0 =&gt;   lr =&gt;  0xa6f9560c  </code></pre>
<p>hook sub_12374</p>
<pre><code class="language-js">                Interceptor.attach(libanon.base.add(0x12374),{ 
                    onEnter: function(args){
                        this.lr = this.context.lr.sub(libanon.base)
                        console.log("0x12374 =&gt; "," lr =&gt; ",this.lr,args[0].readCString(),args[1].readCString());
                    },
                    onLeave: function(retval){

                    }
                })</code></pre>
<p>运行结果，又多了很多的字符串输出：<br/>
这里只截取了很小的一部分</p>
<pre><code class="language-js">0x12374 =&gt;   lr =&gt;  0x65800 451 447 259:9 / / ro,relatime master:1 - ext4 /dev/block/mmcblk0p41 ro,seclabel,inode_readahead_blks=8
492 451 0:12 / /dev rw,nosuid,relatime master:2 - tmpfs tmpfs rw,seclabel,size=1428040k,nr_inodes=357010,mode=755
493 492 0:9 / /dev/pts rw,relatime master:3 - devpts devpts rw,seclabel,mode=600
494 492 0:20 / /dev/cpuctl rw,nosuid,nodev,noexec,relatime master:17 - cgroup none rw,cpu
495 492 0:21 / /dev/cpuset rw,nosuid,nodev,noexec,relatime master:18 - cgroup none rw,cpuset,noprefix,release_agent=/sbin/cpuset_release_agent
496 492 0:22 / /dev/memcg rw,nosuid,nodev,noexec,relatime master:19 - cgroup none rw,memory
497 492 0:26 / /dev/usb-ffs/adb rw,noatime master:32 - functionfs adb rw
498 451 0:3 / /proc rw,relatime master:4 - proc proc rw,gid=3009,hidepid=2
499 451 0:14 / /sys rw,relatime master:5 - sysfs sysfs rw,seclabel
500 499 0:11 / /sys/fs/selinux rw,relatime master:6 - selinuxfs selinuxfs rw
538 499 0:5 / /sys/kernel/debug rw,relatime master:24 - debugfs debugfs rw,seclabel
539 499 0:24 / /sys/fs/fuse/connections rw,relatime master:26 - fusectl none rw
540 499 0:25 / /sys/fs/pstore rw,nosuid,nodev,noexec,relatime master:27 - pstore pstore rw,seclabel
541 451 0:15 / /mnt rw,nosuid,nodev,noexec,relatime master:7 - tmpfs tmpfs rw,seclabel,size=1428040k,nr_inodes=357010,mode=755,gid=1000
542 541 0:15 /user /mnt/installer rw,nosuid,nodev,noexec,relatime master:14 - tmpfs tmpfs rw,seclabel,size=1428040k,nr_inodes=357010,mode=755,gid=1000
543 542 0:86 / /mnt/installer/0/emulated rw,nosuid,nodev,noexec,noatime master:260 - fuse /dev/fuse rw,lazytime,user_id=0,group_id=0,allow_other
544 543 0:85 /0/Android/data /mnt/installer/0/emulated/0/Android/data rw,nosuid,nodev,noexec,noatime master:263 - sdcardfs /data/media rw,fsuid=1023,fsgid=1023,gid=1015,multiuser,mask=6,derive_gid,default_normal,unshared_obb
545 543 0:85 /0/Android/data /mnt/installer/0/emulated/0/Android/data rw,nosuid,nodev,noexec,noatime master:263 - sdcardfs /data/media rw,fsuid=1023,fsgid=1023,gid=1015,multiuser,mask=6,derive_gid,default_normal,unshared_obb
546 543 0:85 /0/Android/obb /mnt/installer/0/emulated/0/Android/obb rw,nosuid,nodev,noexec,noatime master:251 - sdcardfs /data/media rw,fsuid=1023,fsgid=1023,gid=1015,multiuser,mask=6,derive_gid,default_normal,unshared_obb
547 543 0:85 /0/Android/obb /mnt/installer/0/emulated/0/Android/obb rw,nosuid,nodev,noexec,noatime master:251 - sdcardfs /data/media rw,fsuid=1023,fsgid=1023,gid=9997,multiuser,mask=7,derive_gid,default_normal,unshared_obb</code></pre>
<p>关于字符串更多的分析，以后在深入分析。不是今天的目的。</p>
<p>接下来，进入第二部分：从环境本身下手，魔改一个属于自己的 frida-server</p>
<h2 id="54641369_第二部分：使用编译-frida-server-过检测（自定义-fyrrida）">第二部分：使用编译 frida-server 过检测（自定义 fyrrida）</h2>
<h3 id="54641369_使用魔改后的frida-server，过掉检测，告别zygisk-frida-gadget-开源模块">使用魔改后的frida-server，过掉检测，告别Zygisk Frida Gadget 开源模块</h3>
<p>下面的过程分为两步：</p>
<p>在 Ubuntu 22.04.5 上，从 0 到 1 编译官方 Frida 16.5.2</p>
<p>在此基础上，用 ajeossida 进行魔改，生成自己的 fyrrida server</p>
<h3 id="54641369_在-ubuntu-22.04.5-上编译-frida-16.5.2：从系统安装到环境配置全流程">在 Ubuntu 22.04.5 上编译 Frida 16.5.2：从系统安装到环境配置全流程</h3>
<blockquote>
<p>目标：  </p>
<ul>
<li>使用 <code>ubuntu-22.04.5-desktop-amd64.iso</code> 安装一台全新的 Ubuntu 桌面系统  </li>
<li>在虚拟机中配置「共享文件夹」方便和宿主机互传文件  </li>
<li>搭建 <strong>Frida 16.5.2</strong> 所需的构建环境，并从源码编译</li>
</ul>
<p>说明：  </p>
<ul>
<li>以 <strong>Ubuntu 22.04.5 Desktop 64-bit</strong> 为例  </li>
<li>虚拟机平台 <strong>VMware</strong></li>
</ul>
</blockquote>
<hr/>
<h3 id="54641369_一、准备工作">一、准备工作</h3>
<h4 id="54641369_1.-下载-ubuntu-22.04.5-iso">1. 下载 Ubuntu 22.04.5 ISO</h4>
<ul>
<li>
<p>正常安装Ubuntu，阿里云ubuntu-22.04.5-desktop-amd64.iso</p>
<pre><code>https://mirrors.aliyun.com/ubuntu-releases/22.04.4</code></pre>
<h4 id="54641369_2.-新建虚拟机">2. 新建虚拟机</h4>
</li>
<li>
<p>这里以 VMware 为例：</p>
</li>
<li>
<p>新建虚拟机 → 选择「稍后安装操作系统」或直接选择 ISO。</p>
</li>
<li>
<p>客户机操作系统选择：</p>
<p>类型：Linux</p>
<p>版本：Ubuntu 64-bit</p>
</li>
<li>
<p>分配资源（推荐）：</p>
<p>CPU：2 核以上</p>
<p>内存：4 GB 起步，建议 8 GB</p>
<p>磁盘：60 GB 或以上，单文件虚拟磁盘</p>
</li>
<li>
<p>在虚拟机设置中，将 ubuntu-22.04.5-desktop-amd64.iso 挂载为 CD/DVD。</p>
</li>
</ul>
<h4 id="54641369_3.-搭建ubuntu开发环境">3. 搭建Ubuntu开发环境</h4>
<p>创建共享文件夹</p>
<p>右键虚拟机 -&gt; 设置 -&gt; 共享文件夹启动 -&gt; 选择文件夹确认</p>
<p>
<ignore_js_op>
<img aid="2826753" class="zoom" id="aimg_2826753" inpost="1" src="../common_images/164922njjpw6tou44x6ltb.png" width="882"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826753_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_23.png</strong> <em class="xg1">(189.37 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc1M3w4OWJhNTRkYnwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:49 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
</p>
<p>右键打开终端执行</p>
<pre><code>sudo /usr/bin/vmhgfs-fuse .host:/ /mnt/hgfs -o allow_other -o uid=0 -o gid=0 -o umask=022</code></pre>
<p>如果没有/mnt/hgfs创建一个目录，这个时候不是永久的</p>
<p>修改fstab文件</p>
<pre><code>sudo chmod 777 /etc/fstab</code></pre>
<p>最后增加一行(如果使用vim要sudo vim)</p>
<pre><code>.host:/ /mnt/hgfs fuse.vmhgfs-fuse allow_other,uid=0,gid=0,umask=022 0 0</code></pre>
<p>ln把frida文件夹创建一个链接放到桌面上</p>
<pre><code>ln -s /mnt/hgfs/gx ~/Desktop/</code></pre>
<p>这个时候桌面出现frida，它在右下角</p>
<p>
<ignore_js_op>
<img aid="2826754" class="zoom" id="aimg_2826754" inpost="1" src="../common_images/164924maasvo03hbyh4vah.png" width="362"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826754_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_24.png</strong> <em class="xg1">(33.2 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc1NHxhZWI0YjY3YXwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:49 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
</p>
<p>更新包(这些打开终端直接执行就可以，简单)</p>
<pre><code>sudo apt update</code></pre>
<p>安装gcc编译器相关的</p>
<pre><code>sudo apt install build-essential</code></pre>
<p>安装git，vim</p>
<pre><code>sudo apt install git
sudo apt install vim
sudo apt install curl</code></pre>
<p>安装nvm(用来安装node的)</p>
<pre><code>curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.4/install.sh | bash</code></pre>
<p>查看node安装版本(node 20.10最好)</p>
<pre><code>nvm ls-remote</code></pre>
<p>安装</p>
<pre><code>nvm install 20.10.0</code></pre>
<p>安装配置ndk开发环境</p>
<p>搜索ndk下载，下载ndk25版本的，可以window下载放到共享文件夹里面去。</p>
<pre><code>https://dl.google.com/android/repository/android-ndk-r25c-linux.zip</code></pre>
<p>创建value目录在Home里面</p>
<p>
<ignore_js_op>
<img aid="2826755" class="zoom" id="aimg_2826755" inpost="1" src="../common_images/164926hxq1ttcpt804q4c0.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826755_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_25.png</strong> <em class="xg1">(195.88 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc1NXxhNjNlNDkwYnwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:49 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
</p>
<p>创建好了之后解压在home里面，设置~/.bashrc环境变量~代指home</p>
<pre><code>vim ~/.bashrc

下面这两行加到文件最后的位置去，这两个是环境变量，其中PATH就是我们执行bin相关的位置
export ANDROID_NDK_ROOT=~/value/android-ndk-r25c
export PATH=$PATH:$ANDROID_NDK_ROOT</code></pre>
<p>ANDROID_NDK_ROOT是frida需要的</p>
<p>然后执行更新环境变量</p>
<pre><code>source ~/.bashrc</code></pre>
<h4 id="54641369_4.-编译官方-frida-core（为后续魔改打基础）">4. 编译官方 frida-core（为后续魔改打基础）</h4>
<p>这一小节的目标不是“立刻产出可躲检测版本”，而是：</p>
<p>先保证你在本机能 从源码 → 原版 frida-server 的整个过程跑通，<br/>
后面再在这个基础上去做魔改，会轻松很多。</p>
<p>在文件夹里面下载frida-core源码，我只需要frida-server，只拉取frida-core就行了，不用拉取整个frida</p>
<pre><code>git clone https://github.com/frida/frida-core.git</code></pre>
<p>cd进去frida-core文件夹，执行加载子模块</p>
<pre><code>git submodule update --init --recursive</code></pre>
<p>配置（我这里使用android-arm64，是因为我的手机是arm64,）<br/>
可以选择：["android-arm64", "android-arm", "android-x86_64", "android-x86"]</p>
<pre><code>./configure --host=android-arm64</code></pre>
<p>这样就算是成功了：<br/>
<ignore_js_op>
<img aid="2826757" class="zoom" id="aimg_2826757" inpost="1" src="../common_images/164931omd8ezvxtfh4tnwq.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826757_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_27.png</strong> <em class="xg1">(876.43 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc1N3wyNzBkYzJiMHwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:49 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
</p>
<p>使用 make 编译，注意arm64的个数是285</p>
<p>
<ignore_js_op>
<img aid="2826756" class="zoom" id="aimg_2826756" inpost="1" src="../common_images/164928wgxbb6f4b1tiyvve.png" width="860"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826756_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_26.png</strong> <em class="xg1">(57.94 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc1Nnw2MmYxZGVjZnwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:49 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
</p>
<pre><code>make</code></pre>
<p>后面要魔改frida，这里必须要先编译一次。</p>
<p>重新编译直接把build全部删掉就可以</p>
<p>如果后面编译不了，删除deps目录，删除build目录</p>
<h3 id="54641369_二.-使用-ajeossida-魔改生成固定版本的-frida（fyrrida）">二. 使用 ajeossida 魔改生成固定版本的 frida（fyrrida）</h3>
<p><a href="https://github.com/hackcatml/ajeossida" rel="noopener noreferrer nofollow" target="_blank">使用了开源库ajeossida进行编译</a></p>
<p>不想要自己编译的，可以在开源库的release里面去下载成品，不用关心后面的内容。</p>
<h4 id="54641369_1.-在-ubuntu-22.04-上打造「fyrrida」――基于-frida-16.5.2-的自定义隐藏版本">1. 在 Ubuntu 22.04 上打造「fyrrida」――基于 frida 16.5.2 的自定义隐藏版本</h4>
<p>前面我们已经在 Ubuntu 22.04.5 上完成了 Frida 16.5.2 的基础编译环境。<br/>
在此基础上，使用开源库魔改编译一个自己的frida-server：</p>
<ul>
<li>基于 Frida 16.5.2  </li>
<li>使用第三方脚本（如 <code>hackcatml/ajeossida</code>）  </li>
<li><strong>自动改名 &amp; 去掉常见 Frida 特征</strong>  </li>
<li>编译出自己的「定制版 Frida」，这里命名为：<strong>fyrrida</strong></li>
</ul>
<blockquote>
<p>⚠️ 说明  </p>
<ul>
<li>本节重点在于“改名 + 去特征 + 固定版本 16.5.2”的流程思路。  </li>
<li>代码片段可根据本地真实路径微调。  </li>
<li>本节默认你已经完成前文「搭建 Frida 16.5.2 的编译环境」。</li>
</ul>
</blockquote>
<hr/>
<h4 id="54641369_2.-整体思路可以概括为三步：">2. 整体思路可以概括为三步：</h4>
<ol>
<li>
<p><strong>准备构建脚本仓库</strong><br/>
使用 <code>ajeossida</code> 项目，对 Frida 做一层“包装”：统一改名、注释掉一些经典 hook 点、修改线程名等。</p>
</li>
<li>
<p><strong>强制使用 Frida 16.5.2 源码 + 自定义名字 <code>fyrrida</code></strong>  </p>
<ul>
<li>修改脚本的 <code>git_clone_repo()</code>：clone 时直接 checkout 16.5.2 tag。  </li>
<li>把默认的 <code>CUSTOM_NAME = "ajeossida"</code> 改为 <code>CUSTOM_NAME = "fyrrida"</code>。</li>
</ul>
</li>
<li>
<p><strong>执行构建脚本，生成 fyrrida server / gadget</strong>  </p>
<ul>
<li>以 Android 架构为例生成：<br/>
<code>fyrrida-server-16.5.2-android-arm64</code>、<code>fyrrida-gadget-16.5.2-android-arm64.so</code> 等。  </li>
<li>在手机上用 <code>fyrrida-server-16.5.2-android-arm64</code> 替代原版 <code>frida-server</code>。</li>
</ul>
</li>
</ol>
<hr/>
<h4 id="54641369_3.-获取构建脚本仓库">3. 获取构建脚本仓库</h4>
<p>在 Ubuntu 里：</p>
<pre><code class="language-bash">cd /home/fyr/value
git clone https://github.com/hackcatml/ajeossida.git
cd ajeossida</code></pre>
<p>完成后的目录结构是：<br/>
<ignore_js_op>
<img aid="2826758" class="zoom" id="aimg_2826758" inpost="1" src="../common_images/164933z2ii1vu9s001h311.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826758_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_28.png</strong> <em class="xg1">(185.94 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc1OHwyODQyMzJhYnwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:49 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
/home/fyr/value</p>
<h4 id="54641369_4.-修改代码，指定要编辑的frida版本：">4. 修改代码，指定要编辑的frida版本：</h4>
<ul>
<li>cd /home/fyr/value/ajeossida</li>
</ul>
<p>找到main_ubuntu_android.py修改以下代码</p>
<p>修改代码，指定要编辑的frida版本：</p>
<pre><code class="language-py">#原代码：
CUSTOM_NAME = "ajeossida"
def git_clone_repo():
    repo_url = "https://github.com/frida/frida.git"
    destination_dir = os.path.join(os.getcwd(), CUSTOM_NAME)

    print(f"\n Cloning repository {repo_url} to {destination_dir}...")
    run_command(f"git clone --recurse-submodules {repo_url} {destination_dir}")

#修改后：
CUSTOM_NAME = "fyrrida"
def git_clone_repo():
    repo_url = "https://github.com/frida/frida.git"
    destination_dir = os.path.join(os.getcwd(), CUSTOM_NAME)
    tag = "16.5.2"

    print(f"\n Cloning repository {repo_url} (tag {tag}) to {destination_dir}...")
    # --branch 指定 tag/分支，--depth 1 只拉这一版，速度快很多
    run_command(
        f"git clone --recurse-submodules --branch {tag} --depth 1 {repo_url} {destination_dir}"
    )
    return</code></pre>
<p>修改代码后指定拉取的是16.5.2的版本，如果不修改的话，原代码会拉取最新的frida版本进行编译。</p>
<p>开始编译：</p>
<pre><code class="language-shell">python3 main_ubuntu_android.py</code></pre>
<p>编译成功：<br/>
<ignore_js_op>
<img aid="2826761" class="zoom" id="aimg_2826761" inpost="1" src="../common_images/165148cmcvhvnhqu7in866.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826761_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_21.png</strong> <em class="xg1">(933.13 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc2MXw4YTQ3Y2RmYXwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:51 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
</p>
<p>生成的文件，在assets目录下：<br/>
<ignore_js_op>
<img aid="2826752" class="zoom" id="aimg_2826752" inpost="1" src="../common_images/164920ytata47sbx9mrm4b.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826752_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_22.png</strong> <em class="xg1">(447.64 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc1MnxkNjNiZjVlYXwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:49 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
</p>
<h4 id="54641369_5.-使用编译好的arm64版本，过检测">5. 使用编译好的arm64版本，过检测</h4>
<ul>
<li>
<p>解压fyrrida-server-16.5.2-android-arm64.gz，然后推送到手机</p>
<pre><code class="language-shell">adb push frida-server-16.3.3-android-arm64 /data/local/tmp</code></pre>
</li>
<li>
<p>给权限</p>
<pre><code class="language-shell">adb shell
su
cd /data/local/tmp
chmod 777 frida-server-16.3.3-android-arm64 </code></pre>
</li>
<li>
<p>启动frida-server</p>
<pre><code class="language-shell">./frida-server-16.3.3-android-arm64 -l 0.0.0.0:14725</code></pre>
</li>
<li>
<p>端口转发</p>
<pre><code class="language-shell">adb forward tcp:14725 tcp:14725</code></pre>
</li>
<li>
<p>执行脚本</p>
<pre><code class="language-js">frida -H 127.0.0.1:14725 -f com.Hyatt.hyt -l hook_dexprotectB848.js</code></pre>
<p>结果，使用魔改的frida-server，脱离Zygisk Frida Gadget 开源模块。也实现了过检测：<br/>
<ignore_js_op>
<img aid="2826759" class="zoom" id="aimg_2826759" inpost="1" src="../common_images/164936lylgt5w2dqaiidxy.png" width="1080"/>
<div class="tip tip_4 aimg_tip" disautofocus="true" id="aimg_2826759_menu" style="position: absolute; display: none">
<div class="xs0">
<p><strong>img_29.png</strong> <em class="xg1">(361.75 KB, 下载次数: 0)</em></p>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjc1OXw1ODY5MjYxYnwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p class="xg1 y">2026-1-12 16:49 上传</p>
</div>
<div class="tip_horn"></div>
</div>
</ignore_js_op>
<br/>
可以看到：</p>
</li>
</ul>
<p>在不依赖 Zygisk Frida Gadget 模块的前提下</p>
<p>仅使用 魔改后的 fyrrida-server + 迁移后的脚本</p>
<p>同样可以通过当前样本的 DexProtector 检测</p>
<p>这一点非常重要，让环境不再捆死在某个模块 / 某个框架上，<br/>
而是完全掌握在你自己的手里。</p>
<h3 id="54641369_把“一次绕过”变成“长期战斗力”">把“一次绕过”变成“长期战斗力”</h3>
<p>其实这篇文章做的事，就两件：</p>
<ul>
<li>第一部分，把「版本升级」这件烦心事，拆成了一套能反复照抄的 SOP：入口怎么重找、检测点怎么迁移、特征常量怎么复用；</li>
<li>第二部分，把「环境被盯上」这件隐患，交代成了一条从 Ubuntu 装机、Frida 编译到魔改 server 的完整流水线。</li>
</ul>
<p>前者解决的是<strong>效率问题</strong>：下次 app 再发 6.1.1、6.1.2，你不用一遍遍从 JNI_OnLoad 开始重新看，只要按流程把几个关键偏移和特征重新对齐；<br/>
后者解决的是<strong>生存问题</strong>：哪怕 Zygisk Frida Gadget 被完全针对，你也可以随时从自己的构建环境里，再产一份新版“fyrrida”扔到手机上继续干活。</p>
<p>如果你已经跟着跑通了一遍，建议现在就做两件小事：</p>
<ol>
<li>把这套 <strong>“版本迁移 SOP” + “魔改 Frida 流水线”</strong>，整理到自己项目/笔记里，当成固定模板；</li>
<li>把脚本、IDA 工程、010 编辑器特征、编译脚本，按 app / 版本号丢进一个私有仓库，后面每次升级就只是「改几行偏移 + 换一版 server」的体力活。</li>
</ol>
<p>安全对抗本身没有"稳定"一说，DexProtector 也不会因为这一篇文章就“被通杀”。<br/>
但只要你的方法论是可复用的、环境是自己可控的，每一次小版本更新、每一次新样本，都会变成你工具箱里多长出来的一颗螺丝钉。</p>
<p>(本文内容由id:小佳、fyrlove、roysue 共同完成，属于小佳的系列体系课里的一部分，APK版本是半年前的不影响最新课程)</p></div>
<div class="parsedown-markdown-end_FLAG_ZXSQ" style="display:none"></div></td></tr></table>
<div class="pattl">
<ignore_js_op>
<dl class="tattl attm">
<dt></dt>
<dd>
<p class="mbn">
<a class="xw1" href="forum.php?mod=attachment&amp;aid=MjgyNjczM3xjNGZmYTNhYnwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" id="aid2826733" onmouseover="showMenu({'ctrlid':this.id,'pos':'12'})" target="_blank">img_2.png</a>
<em class="xg1">(68.56 KB, 下载次数: 0)</em>
</p>
<div class="tip tip_4" disautofocus="true" id="aid2826733_menu" style="display: none">
<div>
<p>
<a href="forum.php?mod=attachment&amp;aid=MjgyNjczM3xjNGZmYTNhYnwxNzY4MjE4NjAyfDU4ODI2OHwyMDg2MDM4&amp;nothumb=yes" target="_blank">下载附件</a>
</p>
<p>
<span class="y">2026-1-12 16:48 上传</span>
<a href="javascript:;" onclick="imageRotate('aimg_2826733', 1)"><img class="vm" src="../common_images/rleft.gif"/></a>
<a href="javascript:;" onclick="imageRotate('aimg_2826733', 2)"><img class="vm" src="../common_images/rright.gif"/></a>
</p>
</div>
<div class="tip_horn"></div>
</div>
<p class="mbn">
</p>
<div class="mbn savephotop">
<img aid="2826733" alt="img_2.png" class="zoom" id="aimg_2826733" src="../common_images/164833e38lj86f8es8ynla.png" title="img_2.png" w="1340" width="1080"/>
</div>
</dd>
</dl>
</ignore_js_op>
</div>
</div>
<div class="cm" id="comment_54641369">
</div>
<div id="post_rate_div_54641369"></div>
</div>
</div>
</td></tr>
<tr><td class="plc plm">
<div class="mtw mbm hm cl" id="p_btn">
<a href="home.php?mod=spacecp&amp;ac=favorite&amp;type=thread&amp;id=2086038&amp;formhash=7f5fdc25" id="k_favorite" onclick="showWindow(this.id, this.href, 'get', 0);" onmouseover="this.title = $('favoritenumber').innerHTML + ' 人收藏'" rel="nofollow" title="收藏本帖"><i><img alt="收藏" src="../common_images/fav.gif"/>收藏<span id="favoritenumber" style="display:none">0</span></i></a>
<a href="javascript:;" id="ak_rate" onclick="showWindow('rate', 'forum.php?mod=misc&amp;action=rate&amp;tid=2086038&amp;pid=54641369', 'get', -1);return false;" title="评分表立场"><i><img alt="免费评分" src="../common_images/agree.gif"/>免费评分</i></a>
<a href="forum.php?mod=collection&amp;action=edit&amp;op=addthread&amp;tid=2086038" id="k_collect" onclick="showWindow(this.id, this.href);return false;" onmouseover="this.title = $('collectionnumber').innerHTML + ' 人淘帖'" rel="nofollow" title="淘好帖进专辑"><i><img alt="分享" src="../common_images/collection.png"/>淘帖<span id="collectionnumber" style="display:none">0</span></i></a>
<a href="forum.php?mod=misc&amp;action=recommend&amp;do=add&amp;tid=2086038&amp;hash=7f5fdc25" id="recommend_add" onclick="ajaxmenu(this, 3000, 1, 0, '43', 'recommendupdate(1)');return false;" onmouseover="this.title = $('recommendv_add').innerHTML + ' 人有用'" rel="nofollow" title="顶一下"><i><img alt="有用" src="../common_images/rec_add.gif"/>有用<span id="recommendv_add" style="display:none">0</span></i></a>
<a class="followp" false;="" href="" onclick='showWindow("csu_wechat_scan_qrcode","plugin.php?id=csu_wechat_scan:share&amp;tid=2086038","get",0);' return=""><i><img src="../common_images/wx.png"/>分享到朋友圈</i></a></div>
<div class="sign" style="max-height:200px;maxHeightIE:200px;">https://fyrlove.github.io/</div>
<div class="vw50_kfc_pb"><span style="color:#008000;"><p>发帖前要善用<strong>【<a href="//www.52pojie.cn/search.php" target="_blank">论坛搜索</a>】</strong>功能，那里可能会有你要找的答案或者已经有人发布过相同内容了，请勿重复发帖。</p></span></div></td>
</tr>
<tr id="_postposition54641369"></tr>
<tr>
<td class="pls"></td>
<td class="plc" style="overflow:visible;">
<div class="po hin">
<div class="pob cl">
<em>
<a class="cmmnt" href="forum.php?mod=misc&amp;action=comment&amp;tid=2086038&amp;pid=54641369&amp;extra=page%3D1&amp;page=1" onclick="showWindow('comment', this.href, 'get', 0)">点评</a><a class="fastre" href="forum.php?mod=post&amp;action=reply&amp;fid=65&amp;tid=2086038&amp;reppost=54641369&amp;extra=page%3D1&amp;page=1" onclick="showWindow('reply', this.href)" rel="nofollow">回复</a>
</em>
<p>
<a href="javascript:;" onclick="showWindow('miscreport54641369', 'misc.php?mod=report&amp;rtype=post&amp;rid=54641369&amp;tid=2086038&amp;fid=65', 'get', -1);return false;">举报</a>
</p>
</div>
</div>
</td>
</tr>
<tr class="ad">
<td class="pls">
</td>
<td class="plc">
</td>
</tr>
</table>
</div><div class="pl" id="postlistreply"><div class="viewthread_table" id="post_new" style="display: none"></div></div>
</div>
<form autocomplete="off" id="modactions" method="post" name="modactions">
<input name="formhash" type="hidden" value="7f5fdc25"/>
<input name="optgroup" type="hidden"/>
<input name="operation" type="hidden"/>
<input name="listextra" type="hidden" value="page%3D1"/>
<input name="page" type="hidden" value="1"/>
</form>
<div class="pgs mtm mbm cl">
<span class="pgb y" id="visitedforumstmp" onmouseover="$('visitedforums').id = 'visitedforumstmp';this.id = 'visitedforums';showMenu({'ctrlid':this.id,'pos':'21'})"><a href="forum-65-1.html">返回列表</a></span>
<a href="javascript:;" id="newspecialtmp" onclick="showWindow('newthread', 'forum.php?mod=post&amp;action=newthread&amp;fid=65')" onmouseover="$('newspecial').id = 'newspecialtmp';this.id = 'newspecial';showMenu({'ctrlid':this.id})" title="发新帖"><img alt="发新帖" src="../common_images/pn_post.png"/></a>
<a href="javascript:;" id="post_replytmp" onclick="showWindow('reply', 'forum.php?mod=post&amp;action=reply&amp;fid=65&amp;tid=2086038')" title="回复"><img alt="回复" src="../common_images/pn_reply.png"/></a>
</div>
<div class="area" id="diyfastposttop"></div>
<div class="pl bm bmw" id="f_pst">
<form action="forum.php?mod=post&amp;action=reply&amp;fid=65&amp;tid=2086038&amp;extra=page%3D1&amp;replysubmit=yes&amp;infloat=yes&amp;handlekey=fastpost" autocomplete="off" id="fastpostform" method="post" onsubmit="return fastpostvalidate(this)">
<table cellpadding="0" cellspacing="0">
<tr>
<td class="pls">
<div class="avatar avtm"><img onerror="this.onerror=null;this.src='https://avatar.52pojie.cn/images/noavatar_middle.gif'" src="../common_images/68_avatar_middle.jpg"/></div></td>
<td class="plc">
<span id="fastpostreturn"></span>
<div class="cl">
<div id="fastposteditor">
<div class="tedt mtn">
<div class="bar">
<span class="y">
<a href="forum.php?mod=post&amp;action=reply&amp;fid=65&amp;tid=2086038" onclick="return switchAdvanceMode(this.href)">高级模式</a>
</span>
<div class="fpd">
<a class="fbld" href="javascript:;" onclick="seditor_insertunit('fastpost', '[b]', '[/b]');doane(event);" title="文字加粗">B</a>
<a class="fclr" href="javascript:;" id="fastpostforecolor" onclick="showColorBox(this.id, 2, 'fastpost');doane(event);" title="设置文字颜色">Color</a>
<a class="fmg" href="javascript:;" id="fastpostimg" onclick="seditor_menu('fastpost', 'img');doane(event);" title="图片">Image</a>
<a class="flnk" href="javascript:;" id="fastposturl" onclick="seditor_menu('fastpost', 'url');doane(event);" title="添加链接">Link</a>
<a class="fqt" href="javascript:;" id="fastpostquote" onclick="seditor_menu('fastpost', 'quote');doane(event);" title="引用">Quote</a>
<a class="fcd" href="javascript:;" id="fastpostcode" onclick="seditor_menu('fastpost', 'code');doane(event);" title="代码">Code</a>
<a class="fsml" href="javascript:;" id="fastpostsml" onclick="showMenu({'ctrlid':this.id,'evt':'click','layer':2});return false;">Smilies</a>
<a class="fat" href="javascript:;" id="fastpostat" onclick="seditor_menu('fastpost', 'at');doane(event);" title="@朋友">@朋友</a>
<span class="pipe z">|</span><span id="spanButtonPlaceholder">上传</span></div></div>
<div class="area">
<textarea class="pt" cols="80" id="fastpostmessage" name="message" onkeydown="seditor_ctlent(event, 'fastpostvalidate($(\'fastpostform\'))');" rows="6" tabindex="4"></textarea>
</div>
</div>
</div>
</div>
<div id="seccheck_fastpost">
</div>
<input id="posttime" name="posttime" type="hidden" value="1768218602"/>
<div class="upfl">
<table border="0" cellpadding="0" cellspacing="0" id="attach_tblheader" style="display: none;">
<tr>
<td>点击附件文件名添加到帖子内容中</td>
<td class="atds">描述</td>
<td class="attv">
阅读权限
<img alt="Tip" class="vm" onmouseover="showTip(this)" src="../common_images/faq.gif" tip="阅读权限按由高到低排列，高于或等于选中组的用户才可以阅读，&lt;b&gt;&lt;font color=blue&gt;添加权限后请勿勾选下方的“转播给听众”功能，否则会导致帖子内容泄漏。&lt;/font&gt;&lt;/b&gt;"/>
</td>
<td class="attpr">吾爱币</td><td class="attc"></td>
</tr>
</table>
<div class="fieldset flash" id="attachlist"></div>
</div>
<input name="formhash" type="hidden" value="7f5fdc25"/>
<input name="usesig" type="hidden" value="1"/>
<input name="subject" type="hidden" value="  "/>
<p class="ptm pnpost">
<a class="y" href="home.php?mod=spacecp&amp;ac=credit&amp;op=rule&amp;fid=65" target="_blank">本版积分规则</a>
<button class="pn pnc vm" id="fastpostsubmit" name="replysubmit" onmouseover="checkpostrule('seccheck_fastpost', 'ac=reply');this.onmouseover=null" tabindex="5" type="submit" value="replysubmit"><strong>发表回复</strong></button>
<span style="padding:0 5px; color:#f44336"><strong>警告：本版块禁止<a href="forum.php?mod=redirect&amp;goto=findpost&amp;ptid=143136&amp;pid=9180499" style="font-style: italic; text-decoration-line: underline;" target="_blank">『灌水』</a>或回复与主题无关内容，违者重罚！</strong></span>
<label class="lb"><input class="pc" name="adddynamic" type="checkbox" value="1"/>回帖并转播</label>
<label for="fastpostrefresh"><input class="pc" id="fastpostrefresh" type="checkbox"/>回帖后跳转到最后一页</label>
</p>
</td>
</tr>
</table>
</form>
</div>
<div class="p_pop blk cl" id="visitedforums_menu" style="display: none;">
<table cellpadding="0" cellspacing="0">
<tr>
<td id="v_forums">
<h3 class="mbn pbn bbda xg1">浏览过的版块</h3>
<ul class="xl xl1">
<li><a href="forum-5-1.html">『脱壳破解区』</a></li><li><a href="forum-69-1.html">『Android UnPackMe◇CrackMe◇KeyGenMe◇ReverseMe』</a></li><li><a href="forum-13-1.html">『站点公告』</a></li><li><a href="forum-24-1.html">『编程语言区』</a></li><li><a href="forum-2-1.html">『原创发布区』</a></li></ul>
</td>
</tr>
</table>
</div>
</div>
<div class="wp mtn">
<div class="area" id="diy3"></div>
</div>
</div>
<div class="wp vw50_kfc_f"><div class="res-footer-note"><p align="left"><br/><font color="#ff0000">免责声明：<br/>吾爱破解所发布的一切破解补丁、注册机和注册信息及软件的解密分析文章仅限用于学习和研究目的；不得将上述内容用于商业或者非法用途，否则，一切后果请用户自负。本站信息来自网络，版权争议与本站无关。您必须在下载后的24个小时之内，从您的电脑中彻底删除上述内容。如果您喜欢该程序，请支持正版软件，购买注册，得到更好的正版服务。如有侵权请邮件与我们联系处理。</font></p>
<p align="right"><font color="#ff0000" face="Comic Sans MS">Mail To:Service@52pojie.cn</font></p></div></div>
<style type="text/css"> 
#scrolltop {
   display: none;
}
ul#navmenu ul
{ 
display: none; 
position: absolute; 
left: -233px;
bottom: 5px;
} 
ul#navmenu li:hover ul ul, 
ul#navmenu li.iehover ul ul,  { 
display: none; 
} 
ul#navmenu li:hover ul, 
ul#navmenu ul li:hover ul, 
ul#navmenu ul ul li:hover ul, 
ul#navmenu li.iehover ul, 
ul#navmenu ul li.iehover ul, 
ul#navmenu ul ul li.iehover ul { 
display: block; 
} 

#jz52top a {margin: 6px 0;}

#jz52top { z-index: 200; visibility: visible; right: 5px; }

#jz52topa { visibility: hidden;}
#jz52top, #jz52top a { border: none;}


#jz52top { position: fixed; bottom: 70px; display: block; width: 40px; background: none repeat scroll 0% 0% transparent; border: 0px #cdcdcd solid; border-radius: 3px; border-top: 0; cursor: pointer; }
#jz52top:hover { text-decoration: none; }

#jz52top a { display: block; width: 40px; height: 40px; padding: 0; line-height: 12px; text-align: center; color: #787878; text-decoration: none; background: #f8f8f8 url('source/plugin/jz52_top/template/jz52top1.png') no-repeat 0 0; border-top: 0px #cdcdcd solid; }

                a.jz52topa:hover { background-position: -40px 0px !important;}
a.replyfast { background-position: 0 -40px !important; }
a.replyfast:hover { background-position: -40px -40px !important;}
a.returnlist { background-position: 0 -80px !important; }
a.returnlist:hover { background-position: -40px -80px !important;}
a.returnboard { background-position: -80px -240px !important; }
a.returnboard:hover { background-position: -120px -240px !important;}
a.jzqr { background-position: 0 -120px !important; }
a.jzqr:hover { background-position: -40px -120px !important;}
                a.jzwx { background-position: 0 -320px !important; }
a.jzwx:hover { background-position: -40px -320px !important;}				
a.jzkf { background-position: -80px 0px !important; }
a.jzkf:hover { background-position: -120px -0px !important;}
a.jzfx { background-position: -80px -40px !important; }
a.jzfx:hover { background-position: -120px -40px !important;}
.jzfxn { background: #fff !important; width: 231px !important; height: 260px !important; }
a.jzlast { background-position: -80px -80px !important; }
a.jzlast:hover { background-position: -120px -80px !important;}
a.jznext { background-position: -80px -120px !important; }
a.jznext:hover { background-position: -120px -120px !important;}	
a.jzxyy { background-position: -80px -120px !important; }
a.jzxyy:hover { background-position: -120px -360px !important;}			
a.jzsct { background-position: 0px -160px !important; }
a.jzsct:hover { background-position: -40px -160px !important;}				
a.jzscb { background-position: -80px -160px !important; }
a.jzscb:hover { background-position: -120px -160px !important;}				
a.jzqqq { background-position: 0px -200px !important; }
a.jzqqq:hover { background-position: -40px -200px !important;}	
                a.jzsoso { background-position: -80px -320px !important; }
a.jzsoso:hover { background-position: -120px -320px !important;}					
a.jzwo { background-position: -80px -200px !important; }
a.jzwo:hover { background-position: -120px -200px !important;}
a.jzzdy { background-position: 0px -240px !important; }
a.jzzdy:hover { background-position: -40px -240px !important;}
a.jzfbzt { background-position: 0px -280px !important; }
a.jzfbzt:hover { background-position: -40px -280px !important;}
a.jzkfzx { background-position: -80px -280px !important; }
a.jzkfzx:hover { background-position: -120px -280px !important;}


#jzqrn { background: #fff !important; width: 231px !important; height: 260px !important; }
#jzqrn { border: 1px solid rgb(210, 210, 210); text-align: center; }
#jzqrn p {
    font-size: 15px;
    padding-bottom: 15px;
    text-align: center;
color: #999;
    font-family: Microsoft YaHei;
}
#jzwon { background: #fff !important; width: 231px !important; height: 260px !important; }
#jzwon { border: 1px solid rgb(210, 210, 210); }
#jzfxn { border: 1px solid rgb(210, 210, 210); }
#jzfxn h3 {
    height: 23px;
    background: none repeat scroll 0% 0% rgb(250, 250, 250);
    border-bottom: 1px solid rgb(236, 236, 236);
    padding: 10px 0px 0px 10px;
}
#jzfxn .bdsharebuttonbox { padding: 13px 0px 0px 20px; }
#jzfxn .bdsharebuttonbox a, #jzfxn .bdsharebuttonbox .bds_more {
    float: left;
    font-size: 12px;
    padding-left: 25px;
    line-height: 16px;
text-align: left;
    height: 16px;
    background: url("http://bdimg.share.baidu.com/static/api/img/share/icons_1_16.png?v=01d441d0.png") no-repeat scroll 0px 0px ;
    background-repeat: no-repeat;
    cursor: pointer;
    margin: 6px 6px 6px 0px;
text-indent: 0;
    overflow: hidden;
width: 68px;
}
#jzfxn .bdsharebuttonbox .bds_qzone {
    background-position: 0px -52px !important;
}
#jzfxn .bdsharebuttonbox .bds_tsina {
    background-position: 0px -104px !important;
}
#jzfxn .bdsharebuttonbox .bds_tqq {
    background-position: 0px -260px !important;
}
#jzfxn .bdsharebuttonbox .bds_renren {
    background-position: 0px -208px !important;
}
#jzfxn .bdsharebuttonbox .bds_tqf {
    background-position: 0px -364px !important;
}
#jzfxn .bdsharebuttonbox .bds_tieba {
    background-position: 0px -728px !important;
}
#jzfxn .bdsharebuttonbox .bds_sqq {
    background-position: 0px -2652px !important;
}
#jzfxn .bdsharebuttonbox .bds_hi {
    background-position: 0px -416px !important;
}
#jzfxn .bdsharebuttonbox .bds_isohu {
    background-position: 0px -3016px !important;
}
#jzfxn .bdsharebuttonbox .bds_weixin {
    background-position: 0px -1612px !important;
}
#jzfxn .bdsharebuttonbox .bds_t163 {
    background-position: 0px -832px !important;
}
#jzfxn .bdsharebuttonbox .bds_tsohu {
    background-position: 0px -520px !important;
}
#jzfxn .bdsharebuttonbox .bds_baidu {
    background-position: 0px -2600px !important;
}
#jzfxn .bdsharebuttonbox .bds_qq {
    background-position: 0px -624px !important;
}
#jz52top a b {
    visibility: hidden;
    font-weight: normal;
}
</style>
<div id="jz52top">
<span><a class="replyfast" href="forum.php?mod=post&amp;action=reply&amp;fid=65&amp;tid=2086038&amp;extra=page%3D1&amp;page=" onclick="showWindow('reply', this.href)" title="快速回复"><b>快速回复</b></a></span>
<span><a class="jzsct" href="home.php?mod=spacecp&amp;ac=favorite&amp;type=thread&amp;id=2086038&amp;formhash=7f5fdc25" id="k_favorite" onclick="showWindow(this.id, this.href, 'get', 0);" onmouseover="this.title = $('favoritenumber').innerHTML + ' 人已收藏'" title="!fav_thread!"><b>收藏帖子</b></a></span>
<span>
<a class="returnlist" hidefocus="true" href="forum-65-1.html" title="返回列表"><b>返回列表</b></a>
</span>
<span><ul id="navmenu"> <li><a class="jzwx" href="javascript:void(0)" title="关注微信"><b>关注微信</b></a> <ul> <div id="jzqrn">
<img alt="wx" height="228" src="../common_images/weixin.jpg" width="228"/>
<p>微信签到每天都送论坛币！</p>
</div> </ul></li></ul> </span>
<span>
<div id="goTopBtn" style="DISPLAY: none"><a class="jz52topa" title="返回顶部"><b>返回顶部</b></a></div>
</span>
</div>
<div class="wp cl" id="ft">
<div class="y" id="flk">
<p>
<a href="forum.php?mod=rss" target="_blank">RSS订阅</a><span class="pipe">|</span><a href="forum.php?mod=misc&amp;action=showdarkroom">小黑屋</a><span class="pipe">|</span><a href="thread-2084166-1-1.html" target="_blank">处罚记录</a><span class="pipe">|</span><a href="mailto:Service@52pojie.cn" target="_blank">联系我们</a><span class="pipe">|</span><strong><a href="https://www.52pojie.cn" target="_blank">吾爱破解 - 52pojie.cn</a></strong>
( <a href="https://beian.miit.gov.cn/" rel="nofollow" target="_blank">京ICP备16042023号 | 京公网安备 11010502030087号</a> )</p>
<p class="xs0">
GMT+8, 2026-1-12 19:50<span id="debuginfo">
</span>
</p>
</div>
<div id="frt">
<p>Powered by <strong>Discuz!</strong></p>
<p class="xs0">Copyright © 2001-2020, Tencent Cloud.</p>
</div></div>
<div id="scrolltop">
<span><a class="replyfast" href="forum.php?mod=post&amp;action=reply&amp;fid=65&amp;tid=2086038&amp;extra=page%3D1&amp;page=1" onclick="showWindow('reply', this.href)" title="快速回复"><b>快速回复</b></a></span>
<span hidefocus="true"><a class="scrolltopa" onclick="window.scrollTo('0','0')" title="返回顶部"><b>返回顶部</b></a></span>
<span>
<a class="returnlist" hidefocus="true" href="forum-65-1.html" title="返回列表"><b>返回列表</b></a>
</span>
</div>
<script>var STYLEID = '1', STATICURL = 'https://static.52pojie.cn/static/', IMGDIR = 'https://static.52pojie.cn/static/image/common', VERHASH = 'q9b', charset = 'gbk', discuz_uid = '588268', cookiepre = 'htVC_2132_', cookiedomain = '', cookiepath = '/', showusercard = '0', attackevasive = '0', disallowfloat = 'login|newthread', creditnotice = '1|威望|点,2|吾爱币|CB,3|贡献值|点,4|悬赏值|点,5|采纳率|%,6|热心值|点,8|违规|次', defaultstyle = './template/default/style/t5', REPORTURL = 'aHR0cHM6Ly93d3cuNTJwb2ppZS5jbi90aHJlYWQtMjA4NjAzOC0xLTEuaHRtbA==', SITEURL = 'https://www.52pojie.cn/', JSPATH = 'https://static.52pojie.cn/cache/', CSSPATH = 'https://static.52pojie.cn/cache/style_', DYNAMICURL = '';</script><script src="https://static.52pojie.cn/cache/common.js?q9b"></script><script>HTMLNODE.className += ' widthauto'</script><script src="https://static.52pojie.cn/cache/forum.js?q9b"></script><script>
initSearchmenu('scbar', '');
</script><script charset="utf-8" src="https://static.52pojie.cn/highlight/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://lib.baomitu.com/tocbot/4.18.0/tocbot.min.js"></script><script>var fid = parseInt('65'), tid = parseInt('2086038');</script><script src="https://static.52pojie.cn/cache/forum_viewthread.js?q9b"></script><script>zoomstatus = parseInt(1);var imagemaxwidth = '1080';var aimgcount = new Array();</script><script>(function(){var basePath = window.location.href.split('#')[0].split('/').pop();tocbot.init({tocSelector: '#markdown_toc_54641369',contentSelector: '#postmessage_54641369',headingSelector: 'h1, h2, h3',collapseDepth: 0,basePath: basePath});})();</script><script reload="1">
aimgcount[54641369] = ['2826732','2826733','2826734','2826735','2826736','2826737','2826738','2826739','2826740','2826741','2826742','2826743','2826744','2826745','2826746','2826747','2826748','2826749','2826750','2826751','2826752','2826753','2826754','2826755','2826756','2826757','2826758','2826759','2826760','2826761'];
attachimggroup(54641369);
var aimgfid = 0;
</script><script>
var postminchars = parseInt('8');
var postmaxchars = parseInt('0');
var disablepostctrl = parseInt('0');
</script><script src="https://static.52pojie.cn/cache/seditor.js?q9b"></script><script reload="1">smilies_show('fastpostsmiliesdiv', 8, 'fastpost');</script><script src="https://static.52pojie.cn/cache/at.js?q9b"></script><script>
var editorid = '';
var ATTACHNUM = {'imageused':0,'imageunused':0,'attachused':0,'attachunused':0}, ATTACHUNUSEDAID = new Array(), IMGUNUSEDAID = new Array();
</script><script src="https://static.52pojie.cn/cache/upload.js?q9b"></script><script>
var upload = new SWFUpload({
upload_url: "https://www.52pojie.cn/misc.php?mod=swfupload&action=swfupload&operation=upload&fid=65",
post_params: {"uid" : "588268", "hash":"8350575a36dbfe0e745a2e3db224679b"},
file_size_limit : "3072",
file_types : "*.rar;*.7z;*.zip;*.txt;*.jpg;*.gif;*.png",
file_types_description : "All Support Formats",
file_upload_limit : 0,
file_queue_limit : 0,
swfupload_preload_handler : preLoad,
swfupload_load_failed_handler : loadFailed,
file_dialog_start_handler : fileDialogStart,
file_queued_handler : fileQueued,
file_queue_error_handler : fileQueueError,
file_dialog_complete_handler : fileDialogComplete,
upload_start_handler : uploadStart,
upload_progress_handler : uploadProgress,
upload_error_handler : uploadError,
upload_success_handler : uploadSuccess,
upload_complete_handler : uploadComplete,
button_image_url : "https://static.52pojie.cn/static/image/common/uploadbutton_small.png",
button_placeholder_id : "spanButtonPlaceholder",
button_width: 17,
button_height: 25,
button_cursor:SWFUpload.CURSOR.HAND,
button_window_mode: "transparent",
custom_settings : {
progressTarget : "attachlist",
uploadSource: 'forum',
uploadType: 'attach',
maxSizePerDay: 52428800,
uploadFrom: 'fastpost'
},
debug: false
});
</script><script>if(getcookie('fastpostrefresh') == 1) {$('fastpostrefresh').checked=true;}</script><script>
$("fastpostmessage").style.background = 'url(https://static.52pojie.cn/static/image/common/bj.gif) no-repeat left top';

$("fastpostmessage").onfocus = function (){
$("fastpostmessage").style = '';
}
$("fastpostmessage").onblur = function (){
if($("fastpostmessage").value == ''){
$("fastpostmessage").style.background = 'url(https://static.52pojie.cn/static/image/common/bj.gif) no-repeat left top';
}
}

 </script><script>
new lazyload();
</script><script>document.onkeyup = function(e){keyPageScroll(e, 0, 0, 'forum.php?mod=viewthread&tid=2086038&extra=page%3D1', 1);}</script><script>
function succeedhandle_followmod(url, msg, values) {
var fObj = $('followmod_'+values['fuid']);
if(values['type'] == 'add') {
fObj.innerHTML = '不收听';
fObj.href = 'home.php?mod=spacecp&ac=follow&op=del&fuid='+values['fuid'];
} else if(values['type'] == 'del') {
fObj.innerHTML = '收听TA';
fObj.href = 'home.php?mod=spacecp&ac=follow&op=add&hash=7f5fdc25&fuid='+values['fuid'];
}
}
fixed_avatar([54641369], 1);
</script><script src="source/plugin/zxsq_markdown/js/code-tools.js?ver=2.8.5"></script><script src="source/plugin/zxsq_markdown/js/zoom.js?ver=2.8.5"></script><script type="text/x-mathjax-config">
	MathJax.Hub.Config({ 
		tex2jax: {
			inlineMath: [["$","$"], ['\\(','\\)']],
			processClass: "math-render",
			ignoreClass: "pct",
		},
		skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code','a'],
		showProcessingMessages: false,
		messageStyle: "none",
		TeX: { equationNumbers: {autoNumber: "AMS"} },
	});
</script><script src="https://lib.baomitu.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML&amp;noContrib"></script><script>
var mw_brush = eval({"asm":["Asm","true"],"c":["C","true"],"cpp":["C++","true"],"csharp":["C#","true"],"java":["Java","true"],"python":["Python","true"],"lua":["Lua","true"],"html":["HTML","true"],"php":["PHP","true"],"javascript":["JavaScript","true"],"css":["CSS","true"],"golang":["Golang","true"],"objc":["Objective-C","true"],"applescript":["AppleScript","true"],"actionscript3":["Actionscript3","true"],"bash":["Bash shell","true"],"coldfusion":["ColdFusion","true"],"delphi":["Delphi","true"],"diff":["Diff","true"],"erlang":["Erlang","true"],"groovy":["Groovy","true"],"javafx":["JavaFX","true"],"pascal":["Pascal","true"],"patch":["Patch","true"],"perl":["Perl","true"],"text":["Plain Text","true"],"powershell":["PowerShell","true"],"ruby":["Ruby","true"],"rails":["Ruby on Rails","true"],"sass":["Sass","true"],"scala":["Scala","true"],"scss":["Scss","true"],"shell":["Shell","true"],"sql":["SQL","true"],"vb":["Visual Basic","true"],"vbnet":["Visual Basic .NET","true"],"xhtml":["XHTML","true"],"xml":["XML","true"],"xslt":["XSLT","true"],"aauto":["AAuto","true"],"il":["IL","true"]});
var mw_gutter = 1;
var mw_lang_codebox = { 'select_lang': '请输入要插入的代码<br>选择语言：', 'show_gutter': '显示行号：', 'your_code': '你的代码：', 'close': '关闭', 'submit': '提交', 'cancle': '取消' };
</script><script src="https://static.52pojie.cn/mw_syntaxhighlighter/static/js/mw_syntaxhighlighter.js?q9b"></script><script reload="1">mw_syntaxhighlighter("fastpost");</script><script async="" defer="" src="/static/js/index.min.js"></script><script src="https://static.52pojie.cn/noti/noti.js?q9b"></script><script>
time=1768218602;
activemode = true;
hookCredit();
if(activemode)ifvisible.now();
setTimeout(function () { noti_run('&type=3_3_1&h=7f5fdc25', 10000, 180000);}, 90000);
</script><script> 
function goTopEx() {
 var obj = document.getElementById("goTopBtn");

 function getScrollTop() {
 return document.documentElement.scrollTop || document.body.scrollTop;
 }

 function setScrollTop(value) {
 if (document.documentElement.scrollTop) {
 document.documentElement.scrollTop = value;
 } else {
 document.body.scrollTop = value;
 }

 }
 window.onscroll = function() {
 getScrollTop() > 0 ? obj.style.display = "" : obj.style.display = "none";
 var h = document.body.scrollHeight - getScrollTop() - obj.offsetTop - obj.offsetHeight;
 obj.style.bottom = 0 + "px";
 if (h < 350) {
 obj.style.bottom = 340 + "px";
 obj.style.top = "auto";
 }


 }
 obj.onclick = function() {
 function scrollToTop() {
 let y = getScrollTop();
 const interval = setInterval(function() {
 if (getScrollTop() - 5 > y) {
 // User trying to scroll - abort
 clearInterval(interval);
 return;
 }
 y = y / 1.1;
 setScrollTop(y);
 if (y < 1) {
 clearInterval(interval);
 setScrollTop(0);
 }
 }, 10);
 }
 scrollToTop()
 }
}
</script><script type="text/javascript">goTopEx();</script><script>
var _hmt = _hmt || [];
(function() {
 var hm = document.createElement("script");
 hm.src = "https://hm.baidu.com/hm.js?46d556462595ed05e05f009cdafff31a";
 var s = document.getElementsByTagName("script")[0]; 
 s.parentNode.insertBefore(hm, s);
})();
</script><script src="home.php?mod=spacecp&amp;ac=follow&amp;op=checkfeed&amp;rand=1768218602"></script><script>_attachEvent(window, 'scroll', function () { showTopLink(); });checkBlind();</script></link></body>
</html>
